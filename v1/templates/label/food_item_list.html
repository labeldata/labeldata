{% extends "base.html" %}
{% load static %}
{% block title %}제품 조회{% endblock %}
{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">제품 조회 및 복사</h2>

    {% include 'includes/search_filter.html' with action_url='label:food_item_list' page_type='product' search_values=search_values food_category=food_category items_per_page=items_per_page show_food_category=False %}

    <div class="table-responsive">
        {% if imported_mode %}
        <table class="table table-bordered table-hover common-table">
            <thead>
                <tr>
                    <th class="text-center align-middle" style="width: 3%;">번호</th>
                    <th style="width: 15%;">제품명
                        <span class="sort-buttons">
                            <a href="?sort=prduct_korean_nm&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▲</a>
                            <a href="?sort=prduct_korean_nm&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▼</a>
                        </span>
                    </th>
                    <th style="width: 7%;">식품유형
                        <span class="sort-buttons">
                            <a href="?sort=itm_nm&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▲</a>
                            <a href="?sort=itm_nm&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▼</a>
                        </span>
                    </th>
                    <th style="width: 7%;">수출국
                        <span class="sort-buttons">
                            <a href="?sort=xport_ntncd_nm&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▲</a>
                            <a href="?sort=xport_ntncd_nm&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▼</a>
                        </span>
                    </th>
                    <th style="width: 10%;">수입업체명
                        <span class="sort-buttons">
                            <a href="?sort=bsn_ofc_name&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▲</a>
                            <a href="?sort=bsn_ofc_name&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▼</a>
                        </span>
                    </th>
                    <th style="width: 15%;">제조사명
                        <span class="sort-buttons">
                            <a href="?sort=ovsmnfst_nm&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▲</a>
                            <a href="?sort=ovsmnfst_nm&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▼</a>
                        </span>
                    </th>
                    <th style="width: 15%;">원재료명
                    </th>
                    <th style="width: 10%;">소비기한
                        <span class="sort-buttons">
                            <a href="?sort=expirde_dtm&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▲</a>
                            <a href="?sort=expirde_dtm&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▼</a>
                        </span>
                    </th>
                    <th style="width: 7%;">수입일
                        <span class="sort-buttons">
                            <a href="?sort=procs_dtm&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▲</a>
                            <a href="?sort=procs_dtm&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▼</a>
                        </span>
                    </th>
                </tr>
            </thead>
            <tbody>
                {% for item in imported_items %}
                <tr onclick="openImportedDetailPopup('{{ item.id }}')" style="cursor: pointer;">                    <td class="ellipsis-cell text-center align-middle" title="{{ forloop.counter }}">{{ forloop.counter }}</td>
                    <td class="ellipsis-cell" title="{{ item.prduct_korean_nm|default:'' }}">{{ item.prduct_korean_nm|default:"" }}</td>
                    <td class="ellipsis-cell" title="{{ item.itm_nm|default:'' }}">{{ item.itm_nm|default:"" }}</td>
                    <td class="ellipsis-cell" title="{{ item.xport_ntncd_nm|default:'' }}">{{ item.xport_ntncd_nm|default:"" }}</td>
                    <td class="ellipsis-cell" title="{{ item.bsn_ofc_name|default:'' }}">{{ item.bsn_ofc_name|default:"" }}</td>
                    <td class="ellipsis-cell" title="{{ item.ovsmnfst_nm|default:'' }}">{{ item.ovsmnfst_nm|default:"" }}</td>
                    <td class="ellipsis-cell" title="{{ item.irdnt_nm|default:'' }}">{{ item.irdnt_nm|default:"" }}</td>
                    <td class="ellipsis-cell" title="{{ item.expirde_dtm|default:'' }}">{{ item.expirde_dtm|default:"" }}</td>
                    <td class="ellipsis-cell" title="{{ item.procs_dtm|default:'' }}">{{ item.procs_dtm|default:"" }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="9" class="text-center text-muted">수입식품이 없습니다.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <table class="table table-bordered table-hover common-table">
            <thead>
                <tr>
                    <th class="text-center align-middle" style="width: 4%;">번호</th>
                    <th style="width: 10%;">품목보고번호
                        <span class="sort-buttons">
                            <a href="?sort=prdlst_report_no&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▲</a>
                            <a href="?sort=prdlst_report_no&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▼</a>
                        </span>
                    </th>
                    <th style="width: 20%;">제품명
                        <span class="sort-buttons">
                            <a href="?sort=prdlst_nm&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▲</a>
                            <a href="?sort=prdlst_nm&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▼</a>
                        </span>
                    </th>
                    <th style="width: 10%;">식품유형
                        <span class="sort-buttons">
                            <a href="?sort=prdlst_dcnm&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▲</a>
                            <a href="?sort=prdlst_dcnm&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▼</a>
                        </span>
                    </th>
                    <th style="width: 15%;">제조사명
                        <span class="sort-buttons">
                            <a href="?sort=bssh_nm&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▲</a>
                            <a href="?sort=bssh_nm&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▼</a>
                        </span>
                    </th>
                    <th style="width: 10%;">소비기한
                        <span class="sort-buttons">
                            <a href="?sort=pog_daycnt&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▲</a>
                            <a href="?sort=pog_daycnt&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▼</a>
                        </span>
                    </th>
                    <th style="width: 10%;">포장재질
                        <!-- 정렬 버튼 제거 -->
                    </th>
                    <th style="width: 15%;">원재료명
                        <!-- 정렬 버튼 제거 -->
                    </th>
                    <th style="width: 10%;">허가일자
                        <span class="sort-buttons">
                            <a href="?sort=prms_dt&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▲</a>
                            <a href="?sort=prms_dt&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn sort-blue">▼</a>
                        </span>
                    </th>
                </tr>
            </thead>
            <tbody>
                {% for item in page_obj %}
                <tr onclick="openDetailPopup('{{ item.prdlst_report_no }}')" style="cursor: pointer;">                    <td class="ellipsis-cell text-center align-middle" title="{{ forloop.counter }}">{{ forloop.counter }}</td>
                    <td class="ellipsis-cell" title="{{ item.prdlst_report_no|default:'' }}">{{ item.prdlst_report_no|default:"" }}</td>
                    <td class="ellipsis-cell" title="{{ item.prdlst_nm|default:'' }}">{{ item.prdlst_nm|default:"" }}</td>
                    <td class="ellipsis-cell" title="{{ item.prdlst_dcnm|default:'' }}">{{ item.prdlst_dcnm|default:"" }}</td>
                    <td class="ellipsis-cell" title="{{ item.bssh_nm|default:'' }}">{{ item.bssh_nm|default:"" }}</td>
                    <td class="ellipsis-cell" title="{{ item.pog_daycnt|default:'' }}">{{ item.pog_daycnt|default:"" }}</td>
                    <td class="ellipsis-cell" title="{{ item.frmlc_mtrqlt|default:'' }}">{{ item.frmlc_mtrqlt|default:"" }}</td>
                    <td class="ellipsis-cell" title="{{ item.rawmtrl_nm|default:'' }}">{{ item.rawmtrl_nm|default:"" }}</td>
                    <td class="ellipsis-cell" title="{{ item.prms_dt|default:'' }}">{{ item.prms_dt|default:"" }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="9" class="text-center text-muted">제품이 없습니다.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% endif %}
    </div>

    {% include 'includes/pagination.html' with page_obj=page_obj page_range=page_range %}
</div>

<style>
.ellipsis-cell {
    max-width: 180px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    vertical-align: middle;
    cursor: pointer;
}
.table th, .table td {
    vertical-align: middle !important;
}

/* 검색 필드 포커스 및 입력 효과 */
.form-control:focus {
    background-color: #f8f9fa !important;
    border-color: #007bff !important;
    box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25) !important;
}

/* 입력값이 있는 경우 테두리 효과 */
.form-control.has-value {
    border-color: #28a745 !important;
    border-width: 2px !important;
}

.form-control.has-value:focus {
    background-color: #f8f9fa !important;
    border-color: #007bff !important;
    box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25) !important;
}
</style>

<script src="{% static 'js/label/food_item_list.js' %}?v={{ STATIC_BUILD_DATE }}"></script>
{% endblock %}
