{% extends "base.html" %}
{% load static %}
{% block title %}í‘œì‹œì‚¬í•­ ê´€ë¦¬{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4" style="padding-bottom: 10px;">
      <h2 class="mb-0">í‘œì‹œì‚¬í•­ ì¡°íšŒ ë° ìˆ˜ì •</h2>
      <div class="d-flex align-items-center" style="gap: 10px;">
        <!-- ëª¨ë“œ ì„ íƒ í† ê¸€ -->
        <div class="d-flex align-items-center" style="gap: 6px; padding: 4px 8px; background: #f8f9fa; border-radius: 6px; border: 1px solid #dee2e6;">
          <span style="font-size: 0.8rem; font-weight: 600; color: #495057;">ê¸°ë³¸ í™”ë©´:</span>
          <div class="btn-group btn-group-sm" role="group" aria-label="View mode toggle" style="font-size: 0.75rem;">
            <input type="radio" class="btn-check" name="viewMode" id="viewModeSimple" value="simple" autocomplete="off">
            <label class="btn btn-outline-primary" for="viewModeSimple" title="ê°„í¸ ëª¨ë“œ: í•œëˆˆì— ë³´ê³  ë¹ ë¥´ê²Œ ì‘ì„±" style="padding: 0.15rem 0.5rem; font-size: 0.75rem;">
              ğŸ“‹ ê°„í¸
            </label>
            <input type="radio" class="btn-check" name="viewMode" id="viewModeDetail" value="detail" autocomplete="off" checked>
            <label class="btn btn-outline-primary" for="viewModeDetail" title="ìƒì„¸ ëª¨ë“œ: ì„¸ë°€í•œ í¸ì§‘ê³¼ ì „ë¬¸ ê¸°ëŠ¥" style="padding: 0.15rem 0.5rem; font-size: 0.75rem;">
              âœï¸ ìƒì„¸
            </label>
          </div>
        </div>
        <!-- ê¸°ì¡´ ë²„íŠ¼ë“¤ -->
        <button type="button" class="btn btn-outline-primary btn-sm" onclick="createNewLabel()">ì‹ ê·œ ì‘ì„±</button>
        <button type="button" class="btn btn-outline-primary btn-sm" onclick="bulkCopy()">ì„ íƒ ë³µì‚¬</button>
        <button type="button" class="btn btn-outline-secondary btn-sm" onclick="downloadSelectedLabelsExcel()">ì„ íƒ ë‹¤ìš´ë¡œë“œ</button>
        {% if user.username != 'guest@labeasylabel.com' %}
        <button type="button" class="btn btn-outline-danger btn-sm" onclick="bulkDelete()">ì„ íƒ ì‚­ì œ</button>
        {% endif %}
      </div>
    </div>
    {% if ingredient_id %}
    <div class="alert alert-info d-flex justify-content-between align-items-center" style="margin-bottom: 16px;">
      <div>
        <b>ì›ì¬ë£Œëª…: {{ ingredient_name }}</b>ì™€(ê³¼) ì—°ê²°ëœ í‘œì‹œì‚¬í•­ë§Œ í‘œì‹œ ì¤‘ì…ë‹ˆë‹¤.
      </div>
      <div class="d-flex" style="gap:8px;">
        <a href="/label/my-labels/" class="btn btn-outline-secondary btn-sm">ì „ì²´ ëª©ë¡ ë³´ê¸°</a>
        <button type="button" class="btn btn-outline-primary btn-sm" onclick="window.history.back()">ì´ì „ í˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸°</button>
      </div>
    </div>
    {% endif %}
    {% include 'includes/search_filter.html' with action_url='label:my_label_list' page_type='label' search_values=search_values items_per_page=items_per_page prdlst_report_status=prdlst_report_status %}

    <div class="table-responsive">
        <table class="table table-bordered table-hover common-table align-middle">
            <thead>
                <tr>
                    <th class="text-center align-middle" style="width: 3%;"><input type="checkbox" id="check-all"></th>
                    <th class="text-center align-middle" style="width: 4%;">ë²ˆí˜¸</th>
                    <th style="width: 9%;">í’ˆë³´ì‹ ê³ 
                        <span class="sort-buttons">
                            <a href="?sort=report_no_verify_yn&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn" title="ì˜¤ë¦„ì°¨ìˆœ">
                                <i class="fas fa-caret-up"></i>
                            </a>
                            <a href="?sort=report_no_verify_yn&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn" title="ë‚´ë¦¼ì°¨ìˆœ">
                                <i class="fas fa-caret-down"></i>
                            </a>
                        </span>
                    </th>
                    <th style="width: 16%;">ë¼ë²¨ëª…
                        <span class="sort-buttons">
                            <a href="?sort=my_label_name&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn" title="ì˜¤ë¦„ì°¨ìˆœ">
                                <i class="fas fa-caret-up"></i>
                            </a>
                            <a href="?sort=my_label_name&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn" title="ë‚´ë¦¼ì°¨ìˆœ">
                                <i class="fas fa-caret-down"></i>
                            </a>
                        </span>
                    </th>
                    <th style="width: 16%;">ì œí’ˆëª…
                        <span class="sort-buttons">
                            <a href="?sort=prdlst_nm&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn" title="ì˜¤ë¦„ì°¨ìˆœ">
                                <i class="fas fa-caret-up"></i>
                            </a>
                            <a href="?sort=prdlst_nm&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn" title="ë‚´ë¦¼ì°¨ìˆœ">
                                <i class="fas fa-caret-down"></i>
                            </a>
                        </span>
                    </th>
                    <th style="width: 9%;">ì‹í’ˆìœ í˜•
                        <span class="sort-buttons">
                            <a href="?sort=prdlst_dcnm&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn" title="ì˜¤ë¦„ì°¨ìˆœ">
                                <i class="fas fa-caret-up"></i>
                            </a>
                            <a href="?sort=prdlst_dcnm&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn" title="ë‚´ë¦¼ì°¨ìˆœ">
                                <i class="fas fa-caret-down"></i>
                            </a>
                        </span>
                    </th>
                    <th style="width: 12%;">í’ˆëª©ë³´ê³ ë²ˆí˜¸
                        <span class="sort-buttons">
                            <a href="?sort=prdlst_report_no&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn" title="ì˜¤ë¦„ì°¨ìˆœ">
                                <i class="fas fa-caret-up"></i>
                            </a>
                            <a href="?sort=prdlst_report_no&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn" title="ë‚´ë¦¼ì°¨ìˆœ">
                                <i class="fas fa-caret-down"></i>
                            </a>
                        </span>
                    </th>
                    <th style="width: 11%;">ì œì¡°ì‚¬ëª…
                        <span class="sort-buttons">
                            <a href="?sort=bssh_nm&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn" title="ì˜¤ë¦„ì°¨ìˆœ">
                                <i class="fas fa-caret-up"></i>
                            </a>
                            <a href="?sort=bssh_nm&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn" title="ë‚´ë¦¼ì°¨ìˆœ">
                                <i class="fas fa-caret-down"></i>
                            </a>
                        </span>
                    </th>
                    <th style="width: 9%;">ë³´ê´€ì¡°ê±´
                        <span class="sort-buttons">
                            <a href="?sort=storage_method&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn" title="ì˜¤ë¦„ì°¨ìˆœ">
                                <i class="fas fa-caret-up"></i>
                            </a>
                            <a href="?sort=storage_method&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn" title="ë‚´ë¦¼ì°¨ìˆœ">
                                <i class="fas fa-caret-down"></i>
                            </a>
                        </span>
                    </th>
                    <th style="width: 9%;">í¬ì¥ì¬ì§ˆ
                        <span class="sort-buttons">
                            <a href="?sort=frmlc_mtrqlt&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn" title="ì˜¤ë¦„ì°¨ìˆœ">
                                <i class="fas fa-caret-up"></i>
                            </a>
                            <a href="?sort=frmlc_mtrqlt&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn" title="ë‚´ë¦¼ì°¨ìˆœ">
                                <i class="fas fa-caret-down"></i>
                            </a>
                        </span>
                    </th>
                    <th style="width: 10%;">ì‘ì„±ì¼
                        <span class="sort-buttons">
                            <a href="?sort=update_datetime&order=asc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn" title="ì˜¤ë¦„ì°¨ìˆœ">
                                <i class="fas fa-caret-up"></i>
                            </a>
                            <a href="?sort=update_datetime&order=desc{% if querystring_without_sort %}&{{ querystring_without_sort }}{% endif %}" class="sort-btn" title="ë‚´ë¦¼ì°¨ìˆœ">
                                <i class="fas fa-caret-down"></i>
                            </a>
                        </span>
                    </th>
                </tr>
            </thead>
            <tbody>
                {% for label in page_obj %}
                <tr class="clickable-row" data-label-id="{{ label.my_label_id }}" style="cursor: pointer;">
                    <td class="checkbox-cell" onclick="event.stopPropagation(); toggleCheckbox(this);">
                        <input type="checkbox" class="check-item" value="{{ label.my_label_id }}">
                    </td>
                    <td class="text-center align-middle">{{ forloop.counter }}</td>
                    <td class="ellipsis-cell" title="{{ label.prdlst_report_no }}">
                        {% if label.report_no_verify_YN == 'Y' %}
                            <span class="badge bg-success">ì‹ ê³  ì™„ë£Œ</span>
                        {% else %}
                            <span class="badge bg-secondary">ë¯¸í™•ì¸</span>
                        {% endif %}
                    </td>                    <td class="ellipsis-cell" title="{{ label.my_label_name|default:'' }}">{{ label.my_label_name|default:"" }}</td>
                    <td class="ellipsis-cell" title="{{ label.prdlst_nm|default:'' }}">{{ label.prdlst_nm|default:"" }}</td>
                    <td class="ellipsis-cell" title="{{ label.prdlst_dcnm|default:'' }}">{{ label.prdlst_dcnm|default:"" }}</td>
                    <td class="ellipsis-cell" title="{{ label.prdlst_report_no|default:'' }}">{{ label.prdlst_report_no|default:"" }}</td>
                    <td class="ellipsis-cell" title="{{ label.bssh_nm|default:'' }}">{{ label.bssh_nm|default:"" }}</td>
                    <td class="ellipsis-cell" title="{{ label.storage_method|default:'' }}">{{ label.storage_method|default:"" }}</td>
                    <td class="ellipsis-cell" title="{{ label.frmlc_mtrqlt|default:'' }}">{{ label.frmlc_mtrqlt|default:"" }}</td>
                    <td class="ellipsis-cell" title="{{ label.update_datetime|date:'Y-m-d H:i' }}">
                        {% if label.update_datetime %}
                            {{ label.update_datetime|date:"Y-m-d H:i" }}
                        {% endif %}
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="11" class="text-center text-muted">í‘œì‹œì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    {% include 'includes/pagination.html' with page_obj=page_obj page_range=page_range %}
</div>

<style>
/* í–‰ í˜¸ë²„ íš¨ê³¼ */
.clickable-row:hover {
    background-color: #f0f8ff !important;
    transition: background-color 0.2s ease;
}

.clickable-row {
    transition: background-color 0.2s ease;
}

/* í•œ ì¤„ë§Œ ë³´ì´ê³  ë„˜ì¹˜ë©´ ... ì²˜ë¦¬, ë§ˆìš°ìŠ¤ì˜¤ë²„ì‹œ titleë¡œ ì „ì²´ í‘œì‹œ */
.ellipsis-cell {
    max-width: 180px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    vertical-align: middle;
    cursor: pointer;
}
.table th, .table td {
    vertical-align: middle !important;
}

/* ì²´í¬ë°•ìŠ¤ ì…€ ìŠ¤íƒ€ì¼ ê°œì„  */
.checkbox-cell {
    cursor: pointer;
    padding: 8px !important;
    text-align: center;
    vertical-align: middle;
    position: relative;
}

.checkbox-cell input[type="checkbox"] {
    margin: 0;
    cursor: pointer;
}

.checkbox-cell:hover {
    background-color: #f8f9fa;
}

/* ê²€ìƒ‰ í•„ë“œ í¬ì»¤ìŠ¤ ë° ì…ë ¥ íš¨ê³¼ */
.form-control:focus {
    background-color: #f8f9fa !important;
    border-color: #007bff !important;
    box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25) !important;
}

/* ì…ë ¥ê°’ì´ ìˆëŠ” ê²½ìš° í…Œë‘ë¦¬ íš¨ê³¼ */
.form-control.has-value {
    border-color: #28a745 !important;
    border-width: 2px !important;
}

.form-control.has-value:focus {
    background-color: #f8f9fa !important;
    border-color: #007bff !important;
    box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25) !important;
}
</style>

<script src="{% static 'js/label/my_label_list.js' %}?v={{ STATIC_BUILD_DATE }}"></script>
{% endblock %}
