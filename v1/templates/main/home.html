{% extends 'base.html' %}
{% load static %}

{% block title %}ê°„í¸í•œ í‘œì‹œì‚¬í•­ ì—°êµ¬ì†Œ{% endblock %}

{% block extra_head %}
<!-- Select2 ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€ -->
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

<link rel="stylesheet" href="{% static 'css/label_creation.css' %}">
<link rel="stylesheet" href="{% static 'css/label_preview.css' %}">
<style>
/* --- ì „ì²´ í˜ì´ì§€ ìŠ¤í¬ë¡¤ ë°©ì§€ --- */
html, body {
    overflow: hidden;
    height: 100vh;
    margin: 0;
    padding: 0;
}

/* --- ë°ëª¨ í˜ì´ì§€ ì „ìš© ìŠ¤íƒ€ì¼ --- */
.demo-hero {
    background: linear-gradient(135deg, #38b2ac 0%, #319795 100%);
    color: white;
    padding: 0.8rem 0;
    margin-bottom: 0;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}
.demo-title { 
    font-size: 1.3rem; 
    font-weight: 700; 
    margin-bottom: 0.2rem; 
}
.demo-subtitle { 
    font-size: 0.85rem; 
    opacity: 0.95; 
    margin-bottom: 0; 
}

/* ë©”ì¸ ì»¨í…Œì´ë„ˆ ë†’ì´ ì¡°ì • */
.demo-main-container {
    height: calc(100vh - 80px);
    overflow: hidden;
}

/* íŒ¨ë„ ì»¨í…Œì´ë„ˆ - ë·°í¬íŠ¸ ë†’ì´ ê³ ì • (ì „ì²´ í˜ì´ì§€ ìŠ¤í¬ë¡¤ ë°©ì§€) */
.row.demo-panels {
    height: 100%;
    max-height: 100%;
    overflow: hidden;
    margin-top: 0 !important;
    display: flex;
    flex-wrap: nowrap;
    position: relative;
}

/* ì™¼ìª½ íŒ¨ë„ - ë…ë¦½ ìŠ¤í¬ë¡¤ */
.col-12.col-lg-6.demo-left-panel {
    height: 100%;
    overflow-y: auto;
    overflow-x: hidden;
    padding-right: 15px;
    flex: 0 0 50%;
    max-width: 50%;
    min-width: 30%;
}

/* ì˜¤ë¥¸ìª½ íŒ¨ë„ - ë…ë¦½ ìŠ¤í¬ë¡¤ (ê°€ë¡œ ìŠ¤í¬ë¡¤ ì œê±°) */
.col-12.col-lg-6.demo-right-panel {
    height: 100%;
    overflow-y: auto;
    overflow-x: hidden;
    padding-left: 15px;
    flex: 0 0 50%;
    max-width: 50%;
    min-width: 30%;
}

/* íŒ¨ë„ ë¦¬ì‚¬ì´ì € */
.panel-resizer {
    width: 8px;
    background: #e0e0e0;
    cursor: col-resize;
    position: relative;
    flex-shrink: 0;
    transition: background 0.2s;
    z-index: 10;
}

.panel-resizer:hover {
    background: #38b2ac;
}

.panel-resizer::before {
    content: 'â‹®';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: #666;
    font-size: 1rem;
    pointer-events: none;
}

.panel-resizer.resizing {
    background: #319795;
}

/* ì˜¤ë¥¸ìª½ íŒ¨ë„ ì¹´ë“œ body - ê°€ë¡œ ìŠ¤í¬ë¡¤ ë°©ì§€ */
.demo-right-panel .card-body {
    overflow-x: hidden;
}

/* ë¯¸ë¦¬ë³´ê¸° ì»¨í…ì¸  ì˜ì—­ - ê°€ë¡œ ìŠ¤í¬ë¡¤ë§Œ ì´ ì˜ì—­ì—ì„œ */
.preview-content-area {
    overflow-x: auto;
    overflow-y: auto;
    width: 100%;
    max-height: 600px; /* ìµœëŒ€ ë†’ì´ ì œí•œìœ¼ë¡œ ì„¸ë¡œ ìŠ¤í¬ë¡¤ í™œì„±í™” */
    cursor: grab;
    user-select: none;
}

.preview-content-area.dragging {
    cursor: grabbing;
    user-select: none;
}

.preview-content-area::-webkit-scrollbar {
    height: 8px;
}

.preview-content-area::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 4px;
}

.preview-content-area::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 4px;
}

.preview-content-area::-webkit-scrollbar-thumb:hover {
    background: #555;
}

/* ì¹´ë“œ ë†’ì´ ì¡°ì • - h-100 ì œê±° íš¨ê³¼ */
.demo-left-panel .card,
.demo-right-panel .card {
    height: auto;
    margin-bottom: 1rem;
}

/* 1ì—´ ë ˆì´ì•„ì›ƒ - ì»´íŒ©íŠ¸ ë²„ì „ */
.input-form-area .form-group-row {
    display: flex;
    align-items: center;
    margin-bottom: 0.5rem;
    gap: 8px;
}
.input-form-area .form-group-row.align-start {
    align-items: flex-start;
}
.input-form-area .form-label-cell {
    width: 22%;
    min-width: 110px;
    font-weight: 600;
    font-size: 0.85rem;
    display: flex;
    align-items: center;
}
.input-form-area .form-input-cell {
    width: 78%;
    display: flex;
    align-items: center;
    gap: 5px;
}
.input-form-area .form-input-cell .form-control {
    flex: 1;
    font-size: 0.9rem;
    padding: 0.4rem 0.6rem;
}
.input-form-area textarea.form-control {
    min-height: 38px;
    overflow-y: hidden;
    resize: none;
}
.input-form-area textarea.form-control.auto-resize {
    transition: height 0.1s ease;
    flex: none !important;
    flex-shrink: 0 !important;
}
.input-form-area .btn-sm {
    padding: 0.35rem 0.6rem;
    font-size: 0.85rem;
}

/* ë¯¸ë¦¬ë³´ê¸° ì„¤ì • íŒ¨ë„ - ì»´íŒ©íŠ¸ ë²„ì „ */
#settingsPanelDemo {
    background: #f8f9fa;
    padding: 0.6rem 0.8rem;
    border-radius: 6px;
}

#settingsPanelDemo label {
    font-size: 0.8rem;
    font-weight: 600;
    margin-bottom: 0.2rem;
    color: #495057;
}

#settingsPanelDemo input[type="number"],
#settingsPanelDemo select {
    font-size: 0.85rem;
    padding: 0.25rem 0.4rem;
    height: 30px;
}

/* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
.demo-left-panel::-webkit-scrollbar,
.demo-right-panel::-webkit-scrollbar {
    width: 8px;
}

.demo-left-panel::-webkit-scrollbar-track,
.demo-right-panel::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 4px;
}

.demo-left-panel::-webkit-scrollbar-thumb,
.demo-right-panel::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 4px;
}

.demo-left-panel::-webkit-scrollbar-thumb:hover,
.demo-right-panel::-webkit-scrollbar-thumb:hover {
    background: #555;
}

/* ë¯¸ë¦¬ë³´ê¸° í…Œì´ë¸” í•­ëª©ëª… ê³ ì • ë„ˆë¹„ (home ë°ëª¨ ì „ìš© - 150px) */
#previewContent .preview-table th {
    width: 150px !important;
    min-width: 150px !important;
    max-width: 150px !important;
    white-space: nowrap;
    background-color: #f8f9fa;
    text-align: center;
    font-weight: 500;
    padding: 6px 10px;
    border: 1px solid #dee2e6;
    vertical-align: top;
}

#previewContent .preview-table td {
    word-wrap: break-word;
    overflow-wrap: break-word;
    padding: 6px 10px;
    border: 1px solid #dee2e6;
    vertical-align: top;
}

#previewContent .preview-table {
    table-layout: fixed !important;
    width: 100%;
}

/* label_creation.cssì˜ ì¼ë¶€ ìŠ¤íƒ€ì¼ ì˜¤ë²„ë¼ì´ë“œ (ë°ëª¨ìš©) */
.modern-card { box-shadow: 0 4px 12px rgba(0,0,0,0.08); border: none; }
.card-body { overflow-y: visible !important; }
.input-form-area { max-height: none !important; overflow-y: visible !important; }

/* ë¯¸ë¦¬ë³´ê¸° ì„¤ì • íŒ¨ë„ */
#settingsPanelDemo .row {
    margin-bottom: 0.5rem;
}

/* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ ìŠ¤íƒ€ì¼ */
.form-tabs {
    display: flex;
    gap: 0.15rem; /* 0.25remì—ì„œ 0.15remìœ¼ë¡œ ì¶•ì†Œ */
    margin-bottom: 1rem;
    border-bottom: 2px solid #e9ecef;
    overflow-x: auto;
    white-space: nowrap;
    flex-wrap: nowrap;
}

.form-tab {
    padding: 0.4rem 0.6rem; /* 0.5rem 1remì—ì„œ ì¶•ì†Œ */
    background: transparent;
    border: none;
    border-bottom: 3px solid transparent;
    color: #6c757d;
    font-weight: 500;
    font-size: 0.8rem; /* 0.9remì—ì„œ 0.8remìœ¼ë¡œ ì¶•ì†Œ */
    cursor: pointer;
    transition: all 0.2s;
    flex-shrink: 0;
}

.form-tab:hover {
    color: #0d6efd;
    background: #f8f9fa;
}

.form-tab.active {
    color: #0d6efd;
    border-bottom-color: #0d6efd;
    font-weight: 600;
}

.form-tab i {
    margin-right: 0.3rem; /* 0.5remì—ì„œ 0.3remìœ¼ë¡œ ì¶•ì†Œ */
    font-size: 0.75rem; /* ì•„ì´ì½˜ í¬ê¸° ì¶•ì†Œ */
}

.tab-content-panel {
    display: none;
}

.tab-content-panel.active {
    display: block;
}

/* í”Œë¡œíŒ… ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ */
.floating-nav {
    position: fixed;
    bottom: 20px;
    left: 20px;
    z-index: 1000;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.floating-nav .btn {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    transition: all 0.3s;
}

.floating-nav .btn:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
}

@media (max-width: 991px) {
    .floating-nav {
        bottom: 10px;
        left: 10px;
    }
    .floating-nav .btn {
        width: 40px;
        height: 40px;
    }
}
</style>
{% endblock %}

{% block content %}
<body data-is-authenticated="{% if user.is_authenticated %}true{% else %}false{% endif %}">
<div class="demo-hero">
    <div class="container-fluid px-4">
        <div class="row align-items-center">
            <div class="col-lg-9 col-md-8">
                <div class="d-flex align-items-center gap-3 mb-1">
                    <h1 class="demo-title mb-0">
                        ğŸ“‹ ê°„í¸ ëª¨ë“œ
                    </h1>
                    <button class="btn btn-outline-light btn-sm" onclick="handleDetailModeSwitch()" style="border: 2px solid rgba(255, 255, 255, 0.8);" title="{% if user.is_authenticated %}ìƒì„¸ ëª¨ë“œë¡œ ë³´ê¸°{% else %}íšŒì› ì „ìš© ê¸°ëŠ¥{% endif %}">
                        âœï¸ ìƒì„¸ ëª¨ë“œë¡œ ë³´ê¸°
                        {% if not user.is_authenticated %}<i class="fas fa-lock ms-1" style="font-size: 0.75em; opacity: 0.8;"></i>{% endif %}
                    </button>
                </div>
                <p class="demo-subtitle mb-0">
                    í•œëˆˆì— ë³´ê³  ë¹ ë¥´ê²Œ ì‘ì„± - ìƒ˜í”Œ ë°ì´í„°ë¥¼ ì„ íƒí•˜ê±°ë‚˜ ì§ì ‘ ì…ë ¥í•˜ì—¬ ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°ë¥¼ í™•ì¸í•˜ì„¸ìš”. ì‹ì•½ì²˜ì— ì‹ ê³ ëœ ì œí’ˆ ì •ë³´ëŠ” ì œí’ˆ ì¡°íšŒì—ì„œ í™•ì¸í•˜ì„¸ìš”.(êµ­ë‚´, ìˆ˜ì…)<br>
                </p>
            </div>
            <div class="col-lg-3 col-md-4 text-end">
                <div class="d-flex justify-content-end gap-2">
                    <button class="btn btn-outline-light" onclick="handleListNavigation()" style="border-radius: 8px; font-weight: 600; padding: 0.6rem 1.2rem; white-space: nowrap; border: 2px solid rgba(255, 255, 255, 0.8);" title="{% if user.is_authenticated %}í‘œì‹œì‚¬í•­ ì‘ì„± ë¦¬ìŠ¤íŠ¸ë¡œ ëŒì•„ê°€ê¸°{% else %}íšŒì› ì „ìš© ê¸°ëŠ¥{% endif %}">
                        <i class="fas fa-list me-1"></i>í‘œì‹œì‚¬í•­ ë¦¬ìŠ¤íŠ¸ ë³´ê¸°
                        {% if not user.is_authenticated %}<i class="fas fa-lock ms-1" style="font-size: 0.75em; opacity: 0.8;"></i>{% endif %}
                    </button>
                    <button class="btn btn-warning" id="saveLabelBtn" onclick="handleSaveLabel()" style="border-radius: 8px; font-weight: 600; padding: 0.6rem 1.2rem; white-space: nowrap;">
                        <i class="fas fa-save me-1"></i>ì €ì¥í•˜ê¸°
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container-fluid px-4 demo-main-container">
    <div class="row g-3 demo-panels">
        <!-- ì™¼ìª½ íŒ¨ë„: ì…ë ¥ ì˜ì—­ -->
        <div class="col-12 col-lg-6 demo-left-panel">
            <div class="card modern-card">
                <div class="card-header bg-primary text-white">
                    <div class="d-flex justify-content-between align-items-center flex-wrap" style="gap: 8px;">
                        <h5 class="mb-0"><i class="fas fa-edit me-2"></i>1. í‘œì‹œì‚¬í•­ ì…ë ¥</h5>
                        <div class="d-flex flex-wrap gap-1">
                            <button class="btn btn-sm btn-header-primary py-1 px-2" onclick="loadSampleData('beverage')" title="ìŒë£Œ ìƒ˜í”Œ">[ìƒ˜í”Œ] ìŒë£Œ</button>
                            <button class="btn btn-sm btn-header-primary py-1 px-2" onclick="loadSampleData('snack')" title="ê³¼ì ìƒ˜í”Œ">[ìƒ˜í”Œ] ê³¼ì</button>
                            <button class="btn btn-sm btn-header-primary py-1 px-2" onclick="loadSampleData('noodle')" title="ë©´ë¥˜ ìƒ˜í”Œ">[ìƒ˜í”Œ] ë©´ë¥˜</button>
                            <button class="btn btn-sm btn-header-primary py-1 px-2" onclick="loadSampleData('sauce')" title="ì†ŒìŠ¤ ìƒ˜í”Œ">[ìƒ˜í”Œ] ì†ŒìŠ¤</button>
                            <button class="btn btn-sm btn-header-danger py-1 px-2" onclick="resetAllData()" title="ëª¨ë“  ì…ë ¥ ë°ì´í„° ì´ˆê¸°í™”"><i class="fas fa-sync-alt"></i></button>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    
                    <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
                    <div class="form-tabs">
                        <button class="form-tab active" onclick="switchTab('basic')" data-tab="basic">
                            ê¸°ë³¸ì •ë³´
                        </button>
                        <button class="form-tab" onclick="switchTab('ingredients')" data-tab="ingredients">
                            ì›ì¬ë£Œ & ì•Œë ˆë¥´ê¸°
                        </button>
                        <button class="form-tab" onclick="switchTab('notices')" data-tab="notices">
                            ì£¼ì˜ë¬¸êµ¬
                        </button>
                        <button class="form-tab" onclick="switchTab('additional')" data-tab="additional">
                            ê¸°íƒ€í•­ëª©
                        </button>
                    </div>

                    <!-- í‘œì‹œì‚¬í•­ ì…ë ¥ í¼ -->
                    <div class="input-form-area">
                        <form id="demoForm">
                            
                            <!-- íƒ­ 1: ê¸°ë³¸ì •ë³´ -->
                            <div class="tab-content-panel active" id="tab-basic">
                            
                            <!-- ê¸°ë³¸ ì„¤ì •: ì‹í’ˆìœ í˜• ì„ íƒ - ì»´íŒ©íŠ¸ ë²„ì „ -->
                            <div class="mb-2 pb-2 border-bottom" id="step1-row">
                                <div class="d-flex align-items-center" style="gap: 8px;">
                                    <label class="mb-0 text-nowrap" style="font-size:0.85rem; font-weight:600;">
                                        <i class="fas fa-cog me-1"></i>ì‹í’ˆìœ í˜•
                                    </label>
                                    <select id="food_group" name="food_group" class="form-control form-control-sm" style="flex: 1;">
                                        <option value=""></option>
                                        {% for group in food_groups %}
                                        <option value="{{ group }}">{{ group }}</option>
                                        {% endfor %}
                                        <option value="ì‹í’ˆì²¨ê°€ë¬¼">ì‹í’ˆì²¨ê°€ë¬¼</option>
                                        <option value="í˜¼í•©ì œì œ">í˜¼í•©ì œì œ</option>
                                        <option value="ë†ìˆ˜ì¶•ì‚°ë¬¼">ë†ìˆ˜ì¶•ì‚°ë¬¼</option>
                                    </select>
                                    <select id="food_type" name="food_type" class="form-control form-control-sm" style="flex: 1;">
                                        <option value=""></option>
                                        {% for type in food_types %}
                                        <option value="{{ type.food_type }}" data-group="{{ type.food_group }}">
                                            {{ type.food_type }}
                                        </option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            
                            <!-- ë¼ë²¨ëª… -->
                            <div class="form-group-row">
                                <div class="form-label-cell">
                                    <span style="width: 1em; margin-right: 0.5rem;"></span>
                                    <label for="label_name">ë¼ë²¨ëª…</label>
                                </div>
                                <div class="form-input-cell">
                                    <input type="text" name="label_name" id="label_name" class="form-control" placeholder="ë¼ë²¨ëª…ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ë‚´ìš©ë¬¼ë¼ë²¨, ì™¸í¬ì¥ë¼ë²¨ ë“±)">
                                </div>
                            </div>

                            <!-- ì œí’ˆëª… -->
                            <div class="form-group-row">
                                <div class="form-label-cell">
                                    <input type="checkbox" id="chk_prdlst_nm" class="form-check-input me-2" checked>
                                    <label for="chk_prdlst_nm">ì œí’ˆëª…</label>
                                </div>
                                <div class="form-input-cell">
                                    <input type="text" name="prdlst_nm" class="form-control" placeholder="ì œí’ˆëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
                                </div>
                            </div>
                            
                            <!-- íŠ¹ì •ì„±ë¶„ í•¨ëŸ‰ -->
                            <div class="form-group-row">
                                <div class="form-label-cell">
                                    <input type="checkbox" id="chk_ingredient_info" class="form-check-input me-2">
                                    <label for="chk_ingredient_info">íŠ¹ì •ì„±ë¶„ í•¨ëŸ‰</label>
                                </div>
                                <div class="form-input-cell">
                                    <input type="text" name="ingredient_info" class="form-control" placeholder="ì˜ˆ) ë ˆëª¬ì¦™ 5%">
                                </div>
                            </div>
                            
                            <!-- ì‹í’ˆìœ í˜• -->
                            <div class="form-group-row">
                                <div class="form-label-cell">
                                    <input type="checkbox" id="chk_prdlst_dcnm" class="form-check-input me-2">
                                    <label for="chk_prdlst_dcnm">ì‹í’ˆìœ í˜•</label>
                                </div>
                                <div class="form-input-cell">
                                    <input type="text" name="prdlst_dcnm" class="form-control" placeholder="ì‹í’ˆìœ í˜•ì„ ì…ë ¥í•˜ì„¸ìš”">
                                </div>
                            </div>

                            <!-- í’ˆëª©ë³´ê³ ë²ˆí˜¸ -->
                            <div class="form-group-row">
                                <div class="form-label-cell">
                                    <input type="checkbox" id="chk_prdlst_report_no" class="form-check-input me-2">
                                    <label for="chk_prdlst_report_no">í’ˆëª©ë³´ê³ ë²ˆí˜¸</label>
                                </div>
                                <div class="form-input-cell">
                                    <input type="text" name="prdlst_report_no" class="form-control" placeholder="í’ˆëª©ë³´ê³ ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: 2024-12-34567890)" style="flex: 1; min-width: 0;">
                                    <input type="hidden" id="report_no_verify_yn_value" value="">
                                    <button type="button" class="btn btn-outline-primary btn-sm" id="verifyReportNoBtn" onclick="verifyReportNo()" style="white-space: nowrap;">ë²ˆí˜¸ê²€ì¦</button>
                                    <button type="button" class="btn btn-success btn-sm" id="copyProductDataBtn" onclick="copyVerifiedProductData()" style="white-space: nowrap; display: none;">ë³µì‚¬í•˜ê¸°</button>
                                </div>
                            </div>
                            <!-- ê²€ì¦ ê²°ê³¼ ë©”ì‹œì§€ -->
                            <div id="verifyResultMessage" style="display: none; margin-top: 10px;"></div>

                            <!-- ë‚´ìš©ëŸ‰ -->
                            <div class="form-group-row">
                                <div class="form-label-cell">
                                    <input type="checkbox" id="chk_content_weight" class="form-check-input me-2" checked>
                                    <label for="chk_content_weight">ë‚´ìš©ëŸ‰</label>
                                </div>
                                <div class="form-input-cell">
                                    <input type="text" name="content_weight" class="form-control" placeholder="ì˜ˆ) 500ml, 250g">
                                </div>
                            </div>

                            <!-- ì›ì‚°ì§€ -->
                            <div class="form-group-row">
                                <div class="form-label-cell">
                                    <input type="checkbox" id="chk_country_of_origin" name="chk_country_of_origin" class="form-check-input me-2">
                                    <label for="chk_country_of_origin">ì›ì‚°ì§€</label>
                                </div>
                                <div class="form-input-cell">
                                    <select id="countrySelect" class="form-control" style="flex: 0 0 auto; width: 120px;">
                                        <option value="">-- êµ­ê°€ ì„ íƒ --</option>
                                        <option value="ì§ì ‘ì…ë ¥">ì§ì ‘ì…ë ¥</option>
                                        {% for country in countries %}
                                        <option value="{% if country.country_name_ko|slice:'-1:' == 'ì‚°' %}{{ country.country_name_ko }}{% else %}{{ country.country_name_ko }}ì‚°{% endif %}">{% if country.country_name_ko|slice:'-1:' == 'ì‚°' %}{{ country.country_name_ko }}{% else %}{{ country.country_name_ko }}ì‚°{% endif %}</option>
                                        {% endfor %}
                                    </select>
                                    <input type="text" name="country_of_origin" class="form-control" placeholder="ì›ì‚°ì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”" id="countryInput" disabled>
                                </div>
                            </div>
                            
                            <!-- ë³´ê´€ë°©ë²• -->
                            <div class="form-group-row">
                                <div class="form-label-cell">
                                    <input type="checkbox" id="chk_storage_method" class="form-check-input me-2">
                                    <label for="chk_storage_method">ë³´ê´€ë°©ë²•</label>
                                </div>
                                <div class="form-input-cell">
                                    <input type="text" name="storage_method" class="form-control" placeholder="ë³´ê´€ë°©ë²•ì„ ì…ë ¥í•˜ì„¸ìš”">
                                </div>
                            </div>

                            <!-- ì†Œë¹„ê¸°í•œ -->
                            <div class="form-group-row">
                                <div class="form-label-cell">
                                    <input type="checkbox" id="chk_pog_daycnt" class="form-check-input me-2">
                                    <label for="chk_pog_daycnt">ì†Œë¹„ê¸°í•œ</label>
                                </div>
                                <div class="form-input-cell">
                                    <input type="text" name="pog_daycnt" class="form-control" placeholder="ì˜ˆ) ì œì¡°ì¼ë¡œë¶€í„° 24ê°œì›”">
                                </div>
                            </div>
                            
                            </div><!-- end tab-basic -->
                            
                            <!-- íƒ­ 2: ì›ì¬ë£Œ & ì•Œë ˆë¥´ê¸° -->
                            <div class="tab-content-panel" id="tab-ingredients">
                            
                            <!-- ì›ì¬ë£Œëª… -->
                            <div class="form-group-row align-start">
                                <div class="form-label-cell">
                                    <input type="checkbox" id="chk_rawmtrl_nm_display" class="form-check-input me-2">
                                    <label for="chk_rawmtrl_nm_display">ì›ì¬ë£Œëª…</label>
                                </div>
                                <div class="form-input-cell" style="align-items: flex-start;">
                                    <textarea name="rawmtrl_nm_display" class="form-control auto-resize" rows="1" placeholder="ì›ì¬ë£Œëª…(í‘œì‹œ)ì„ ì…ë ¥í•˜ì„¸ìš”" id="rawmtrl_nm_textarea"></textarea>
                                </div>
                            </div>

                            <!-- ì•Œë ˆë¥´ê¸° ê´€ë¦¬ ëª¨ë“ˆ -->
                            <div class="form-group-row align-start" style="background: #fff8e1; padding: 0.8rem; border-radius: 6px; border: 1px solid #ffd54f;">
                                <div class="form-label-cell" style="align-self: flex-start; cursor: pointer;" onclick="toggleAllergenModule()">
                                    <i class="fas fa-exclamation-triangle text-warning me-2"></i>
                                    <label style="font-weight: 700; color: #f57c00; cursor: pointer;">ì•Œë ˆë¥´ê¸° ê´€ë¦¬</label>
                                    <i class="fas fa-chevron-down ms-2" id="allergenModuleToggleIcon" style="font-size: 0.8rem; color: #f57c00;"></i>
                                </div>
                                <div class="form-input-cell" style="flex-direction: column; align-items: stretch; gap: 10px;" id="allergenModuleContent">
                                    
                                    <!-- ì›ì¬ë£Œ ì‚¬ìš© ì•Œë ˆë¥´ê¸° ë¬¼ì§ˆ (ìë™ ê°ì§€ + ìˆ˜ë™ í¸ì§‘) -->
                                    <div>
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <label class="form-label mb-0 label-danger">
                                                ì›ì¬ë£Œ ì‚¬ìš© ì•Œë ˆë¥´ê¸° ë¬¼ì§ˆ
                                            </label>
                                            <button type="button" class="btn btn-outline-secondary btn-sm" onclick="manualDetectAllergens()" style="font-size: 0.7rem; padding: 0.2rem 0.5rem;" title="ì•Œë ˆë¥´ê¸° ë¬¼ì§ˆ ë‹¤ì‹œ ê°ì§€">
                                                <i class="fas fa-sync-alt me-1"></i>ìƒˆë¡œê³ ì¹¨
                                            </button>
                                        </div>
                                        
                                        <!-- ìë™ ê°ì§€ëœ ì•Œë ˆë¥´ê¸° íƒœê·¸ í‘œì‹œ -->
                                        <div id="detectedAllergens" class="p-2 bg-white border rounded position-relative text-sm" style="min-height: 50px;">
                                            <span class="text-muted"><i class="fas fa-info-circle me-1"></i>ì›ì¬ë£Œëª…ì„ ì…ë ¥í•˜ë©´ ìë™ìœ¼ë¡œ ê°ì§€ë©ë‹ˆë‹¤</span>
                                            <!-- ê°ì§€ ìƒíƒœ í‘œì‹œ -->
                                            <div id="allergenDetectingIndicator" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                                                <div class="spinner-border spinner-border-sm text-primary" role="status" style="width: 1.5rem; height: 1.5rem;">
                                                    <span class="visually-hidden">ê°ì§€ ì¤‘...</span>
                                                </div>
                                                <span class="text-primary ms-2" style="font-size: 0.8rem;">ê°ì§€ ì¤‘...</span>
                                            </div>
                                        </div>
                                        
                                        <!-- ì§ì ‘ ì¶”ê°€ ë²„íŠ¼ (ëª¨ë“  í•­ëª©) -->
                                        <div class="mt-2" style="display: flex; flex-wrap: wrap; gap: 5px; align-items: center;">
                                            <span class="text-xs" style="margin-right: 4px;">ì§ì ‘ ì¶”ê°€:</span>
                                            <button type="button" class="btn btn-sm btn-outline-secondary quick-allergen-btn py-0 px-2" data-allergen="ì•Œë¥˜" style="font-size: 0.7rem;">ì•Œë¥˜</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary quick-allergen-btn py-0 px-2" data-allergen="ìš°ìœ " style="font-size: 0.7rem;">ìš°ìœ </button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary quick-allergen-btn py-0 px-2" data-allergen="ë©”ë°€" style="font-size: 0.7rem;">ë©”ë°€</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary quick-allergen-btn py-0 px-2" data-allergen="ë•…ì½©" style="font-size: 0.7rem;">ë•…ì½©</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary quick-allergen-btn py-0 px-2" data-allergen="ëŒ€ë‘" style="font-size: 0.7rem;">ëŒ€ë‘</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary quick-allergen-btn py-0 px-2" data-allergen="ë°€" style="font-size: 0.7rem;">ë°€</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary quick-allergen-btn py-0 px-2" data-allergen="ê³ ë“±ì–´" style="font-size: 0.7rem;">ê³ ë“±ì–´</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary quick-allergen-btn py-0 px-2" data-allergen="ê²Œ" style="font-size: 0.7rem;">ê²Œ</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary quick-allergen-btn py-0 px-2" data-allergen="ìƒˆìš°" style="font-size: 0.7rem;">ìƒˆìš°</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary quick-allergen-btn py-0 px-2" data-allergen="ë¼ì§€ê³ ê¸°" style="font-size: 0.7rem;">ë¼ì§€ê³ ê¸°</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary quick-allergen-btn py-0 px-2" data-allergen="ë³µìˆ­ì•„" style="font-size: 0.7rem;">ë³µìˆ­ì•„</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary quick-allergen-btn py-0 px-2" data-allergen="í† ë§ˆí† " style="font-size: 0.7rem;">í† ë§ˆí† </button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary quick-allergen-btn py-0 px-2" data-allergen="ì•„í™©ì‚°ë¥˜" style="font-size: 0.7rem;">ì•„í™©ì‚°ë¥˜</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary quick-allergen-btn py-0 px-2" data-allergen="í˜¸ë‘" style="font-size: 0.7rem;">í˜¸ë‘</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary quick-allergen-btn py-0 px-2" data-allergen="ì£" style="font-size: 0.7rem;">ì£</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary quick-allergen-btn py-0 px-2" data-allergen="ë‹­ê³ ê¸°" style="font-size: 0.7rem;">ë‹­ê³ ê¸°</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary quick-allergen-btn py-0 px-2" data-allergen="ì‡ ê³ ê¸°" style="font-size: 0.7rem;">ì‡ ê³ ê¸°</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary quick-allergen-btn py-0 px-2" data-allergen="ì˜¤ì§•ì–´" style="font-size: 0.7rem;">ì˜¤ì§•ì–´</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary quick-allergen-btn py-0 px-2" data-allergen="ì¡°ê°œë¥˜" style="font-size: 0.7rem;">ì¡°ê°œë¥˜</button>
                                        </div>
                                        
                                        <!-- ìˆ¨ê²¨ì§„ ì…ë ¥ í•„ë“œ (ì„ íƒëœ ì•Œë ˆë¥´ê¸° ì €ì¥) -->
                                        <input type="hidden" id="selected_ingredient_allergens" name="ingredient_allergens">
                                    </div>
                                    
                                    <!-- ì œì¡°ì‹œì„¤ í˜¼ì… ìš°ë ¤ ì•Œë ˆë¥´ê¸° ë¬¼ì§ˆ (ìˆ˜ë™ ì„ íƒ) -->
                                    <div>
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <label class="form-label mb-0 label-warning">
                                                ì œì¡°ì‹œì„¤ í˜¼ì… ìš°ë ¤ ë¬¼ì§ˆ (ì„ íƒ)
                                            </label>
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" id="toggleAllAllergensBtn" class="btn btn-outline-secondary btn-sm" onclick="toggleAllAllergens()" style="font-size: 0.7rem; padding: 0.2rem 0.5rem;">
                                                    <i class="fas fa-check-double me-1"></i>ì „ì²´ ì„ íƒ
                                                </button>
                                                <button type="button" id="toggleAllergenWarningBtn" class="btn btn-outline-primary btn-sm" onclick="toggleAllergenWarning()" style="font-size: 0.7rem; padding: 0.2rem 0.5rem;">
                                                    <i class="fas fa-arrow-right me-1"></i>ì£¼ì˜ì‚¬í•­ì— ì¶”ê°€
                                                </button>
                                            </div>
                                        </div>
                                        <div class="allergen-selection" style="display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 8px;">
                                            <button type="button" class="btn btn-sm btn-outline-secondary allergen-toggle py-0 px-2" data-allergen="ì•Œë¥˜" style="font-size: 0.7rem;">ì•Œë¥˜</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary allergen-toggle py-0 px-2" data-allergen="ìš°ìœ " style="font-size: 0.7rem;">ìš°ìœ </button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary allergen-toggle py-0 px-2" data-allergen="ë©”ë°€" style="font-size: 0.7rem;">ë©”ë°€</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary allergen-toggle py-0 px-2" data-allergen="ë•…ì½©" style="font-size: 0.7rem;">ë•…ì½©</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary allergen-toggle py-0 px-2" data-allergen="ëŒ€ë‘" style="font-size: 0.7rem;">ëŒ€ë‘</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary allergen-toggle py-0 px-2" data-allergen="ë°€" style="font-size: 0.7rem;">ë°€</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary allergen-toggle py-0 px-2" data-allergen="ê³ ë“±ì–´" style="font-size: 0.7rem;">ê³ ë“±ì–´</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary allergen-toggle py-0 px-2" data-allergen="ê²Œ" style="font-size: 0.7rem;">ê²Œ</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary allergen-toggle py-0 px-2" data-allergen="ìƒˆìš°" style="font-size: 0.7rem;">ìƒˆìš°</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary allergen-toggle py-0 px-2" data-allergen="ë¼ì§€ê³ ê¸°" style="font-size: 0.7rem;">ë¼ì§€ê³ ê¸°</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary allergen-toggle py-0 px-2" data-allergen="ë³µìˆ­ì•„" style="font-size: 0.7rem;">ë³µìˆ­ì•„</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary allergen-toggle py-0 px-2" data-allergen="í† ë§ˆí† " style="font-size: 0.7rem;">í† ë§ˆí† </button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary allergen-toggle py-0 px-2" data-allergen="ì•„í™©ì‚°ë¥˜" style="font-size: 0.7rem;">ì•„í™©ì‚°ë¥˜</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary allergen-toggle py-0 px-2" data-allergen="í˜¸ë‘" style="font-size: 0.7rem;">í˜¸ë‘</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary allergen-toggle py-0 px-2" data-allergen="ì£" style="font-size: 0.7rem;">ì£</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary allergen-toggle py-0 px-2" data-allergen="ë‹­ê³ ê¸°" style="font-size: 0.7rem;">ë‹­ê³ ê¸°</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary allergen-toggle py-0 px-2" data-allergen="ì‡ ê³ ê¸°" style="font-size: 0.7rem;">ì‡ ê³ ê¸°</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary allergen-toggle py-0 px-2" data-allergen="ì˜¤ì§•ì–´" style="font-size: 0.7rem;">ì˜¤ì§•ì–´</button>
                                            <button type="button" class="btn btn-sm btn-outline-secondary allergen-toggle py-0 px-2" data-allergen="ì¡°ê°œë¥˜" style="font-size: 0.7rem;">ì¡°ê°œë¥˜</button>
                                        </div>
                                        <input type="hidden" id="selected_cross_contamination_allergens" name="cross_contamination_allergens">
                                    </div>
                                    
                                    <!-- í˜¼ì… ê²½ê³  ë¬¸êµ¬ ë¯¸ë¦¬ë³´ê¸° -->
                                    <div id="crossContaminationPreview" class="p-2 bg-light border rounded text-sm" style="display: none;">
                                        <strong class="text-warning"><i class="fas fa-exclamation-triangle me-1"></i>ìƒì„±ëœ í˜¼ì… ê²½ê³  ë¬¸êµ¬:</strong>
                                        <div id="crossContaminationText" class="mt-1 text-dark"></div>
                                    </div>
                                </div>
                            </div>

                            </div><!-- end tab-ingredients -->
                            
                            <!-- íƒ­ 3: í‘œì‹œì‚¬í•­ -->
                            <div class="tab-content-panel" id="tab-notices">

                            <!-- ì£¼ì˜ì‚¬í•­ -->
                            <div class="form-group-row align-start">
                                <div class="form-label-cell">
                                    <input type="checkbox" id="chk_cautions" class="form-check-input me-2">
                                    <label for="chk_cautions">ì£¼ì˜ì‚¬í•­</label>
                                </div>
                                <div class="form-input-cell" style="align-items: flex-start; flex-direction: column; gap: 5px; height: auto;">
                                    <!-- ì „ì²´ ì¶”ê°€/í•´ì œ ë²„íŠ¼ -->
                                    <div class="d-flex justify-content-between align-items-center mb-1" style="width: 100%;">
                                        <span style="font-size: 0.75rem; color: #666;">
                                            <i class="fas fa-info-circle me-1"></i>ë¹ ë¥¸ ì…ë ¥ ë²„íŠ¼
                                        </span>
                                        <div class="btn-group btn-group-sm" role="group">
                                            <button type="button" class="btn btn-outline-success btn-sm" onclick="addAllQuickTexts('cautions')" style="font-size: 0.7rem; padding: 0.2rem 0.5rem;">
                                                <i class="fas fa-plus-circle me-1"></i>ì „ì²´ ì¶”ê°€
                                            </button>
                                            <button type="button" class="btn btn-outline-danger btn-sm" onclick="clearAllQuickTexts('cautions')" style="font-size: 0.7rem; padding: 0.2rem 0.5rem;">
                                                <i class="fas fa-eraser me-1"></i>ì¼ê´„ í•´ì œ
                                            </button>
                                        </div>
                                    </div>
                                    <div class="quick-text-buttons" style="display: flex; flex-wrap: wrap; gap: 3px; width: 100%; margin-bottom: 3px;">
                                        <!-- ë²•ì • í•„ìˆ˜ ê²½ê³  -->
                                        <button type="button" class="btn btn-outline-danger btn-sm py-0 px-2 quick-text-toggle" data-field="cautions" data-text="ë¶€ì •Â·ë¶ˆëŸ‰ì‹í’ˆ ì‹ ê³ ëŠ” êµ­ë²ˆì—†ì´ 1399" title="ë¶€ì •ë¶ˆëŸ‰ì‹í’ˆ ì‹ ê³  (ë²•ì • ì˜ë¬´)" style="font-size: 0.7rem;"><i class="fas fa-phone-alt me-1"></i>1399</button>
                                        <button type="button" class="btn btn-outline-danger btn-sm py-0 px-2 quick-text-toggle" data-field="cautions" data-text="ì´ ì œí’ˆì—ëŠ” í˜ë‹ì•Œë¼ë‹Œì´ í•¨ìœ ë˜ì–´ ìˆìŠµë‹ˆë‹¤. (í˜ë‹ì¼€í†¤ë‡¨ì¦ í™˜ì ì£¼ì˜)" title="ì•„ìŠ¤íŒŒíƒ ë²•ì • í•„ìˆ˜ í‘œì‹œ" style="font-size: 0.7rem;"><i class="fas fa-exclamation-circle me-1"></i>í˜ë‹ì•Œë¼ë‹Œ</button>
                                        
                                        <!-- ì¼ë°˜ ê´€ë¦¬ ê²½ê³  -->
                                        <button type="button" class="btn btn-outline-secondary btn-sm py-0 px-2 quick-text-toggle" data-field="cautions" data-text="ê°œë´‰ í›„ì—ëŠ” ë³€ì§ˆë  ìš°ë ¤ê°€ ìˆìœ¼ë‹ˆ ë°˜ë“œì‹œ ë°€ë´‰í•˜ì—¬ ëƒ‰ì¥ ë³´ê´€í•˜ì‹œê³ , ê°€ê¸‰ì  ë¹¨ë¦¬ ì„­ì·¨í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤." title="ê°œë´‰ í›„ ë³´ê´€ ë° ì·¨ê¸‰" style="font-size: 0.7rem;"><i class="fas fa-box-open me-1"></i>ê°œë´‰í›„ë³´ê´€</button>
                                        <button type="button" class="btn btn-outline-secondary btn-sm py-0 px-2 quick-text-toggle" data-field="cautions" data-text="ì§ì‚¬ê´‘ì„ ì„ í”¼í•˜ê³  ì„œëŠ˜í•œ ê³³ì— ë³´ê´€í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤." title="ë³´ê´€ ì¡°ê±´" style="font-size: 0.7rem;"><i class="fas fa-sun me-1"></i>ì§ì‚¬ê´‘ì„ </button>
                                        <button type="button" class="btn btn-outline-secondary btn-sm py-0 px-2 quick-text-toggle" data-field="cautions" data-text="ëƒ‰ë™ ì œí’ˆì€ í•´ë™ í›„ ì¬ëƒ‰ë™í•˜ì§€ ë§ˆì‹œê¸° ë°”ëë‹ˆë‹¤." title="ì¬ëƒ‰ë™ ê¸ˆì§€" style="font-size: 0.7rem;"><i class="fas fa-snowflake me-1"></i>ì¬ëƒ‰ë™ê¸ˆì§€</button>
                                        <button type="button" class="btn btn-outline-secondary btn-sm py-0 px-2 quick-text-toggle" data-field="cautions" data-text="ìš©ê¸°ê°€ íŒŒì†ë˜ê±°ë‚˜ ë¶€í’€ì–´ ìˆëŠ” ê²½ìš° ì„­ì·¨í•˜ì§€ ë§ˆì‹œê¸° ë°”ëë‹ˆë‹¤." title="ìš©ê¸° íŒŒì† ì£¼ì˜" style="font-size: 0.7rem;"><i class="fas fa-box-tissue me-1"></i>ìš©ê¸°íŒŒì†</button>
                                        
                                        <!-- ì•ˆì „ ì£¼ì˜ì‚¬í•­ -->
                                        <button type="button" class="btn btn-outline-secondary btn-sm py-0 px-2 quick-text-toggle" data-field="cautions" data-text="ì–´ë¦°ì´ê°€ ë¨¹ì„ ê²½ìš° ë³´í˜¸ìì˜ ì§€ë„ê°€ í•„ìš”í•©ë‹ˆë‹¤." title="ì–´ë¦°ì´ ì£¼ì˜" style="font-size: 0.7rem;"><i class="fas fa-child me-1"></i>ì–´ë¦°ì´</button>
                                        <button type="button" class="btn btn-outline-secondary btn-sm py-0 px-2 quick-text-toggle" data-field="cautions" data-text="ì§ˆì‹ì˜ ìœ„í—˜ì´ ìˆìœ¼ë‹ˆ ì£¼ì˜í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤." title="ì§ˆì‹ ì£¼ì˜" style="font-size: 0.7rem;"><i class="fas fa-lungs me-1"></i>ì§ˆì‹</button>
                                        <button type="button" class="btn btn-outline-secondary btn-sm py-0 px-2 quick-text-toggle" data-field="cautions" data-text="ëœ¨ê±°ìš°ë‹ˆ í™”ìƒì— ì£¼ì˜í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤." title="í™”ìƒ ì£¼ì˜" style="font-size: 0.7rem;"><i class="fas fa-fire me-1"></i>í™”ìƒ</button>
                                        <button type="button" class="btn btn-outline-secondary btn-sm py-0 px-2 quick-text-toggle" data-field="cautions" data-text="ì œí’ˆ ê°œë´‰ ì‹œ ë‚´ìš©ë¬¼ì´ íŠˆ ìˆ˜ ìˆìœ¼ë‹ˆ ì£¼ì˜í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤." title="ê°œë´‰ ì£¼ì˜" style="font-size: 0.7rem;"><i class="fas fa-spray-can me-1"></i>íŠì£¼ì˜</button>
                                        
                                        <!-- ê±´ê°•ê¸°ëŠ¥ì‹í’ˆ ê´€ë ¨ -->
                                        <button type="button" class="btn btn-outline-info btn-sm py-0 px-2 quick-text-toggle" data-field="cautions" data-text="íŠ¹ì • ì§ˆí™˜ì´ ìˆê±°ë‚˜ ì˜ì•½í’ˆ ë³µìš© ì¤‘ì´ì‹  ë¶„ì€ ì„­ì·¨ ì „ ì˜ì‚¬ ë° ì „ë¬¸ê°€ì™€ ìƒë‹´í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤. ë³¸ ì œí’ˆì€ ì§ˆë³‘ì˜ ì˜ˆë°© ë° ì¹˜ë£Œë¥¼ ìœ„í•œ ì˜ì•½í’ˆì´ ì•„ë‹™ë‹ˆë‹¤." title="ê±´ê°•ê¸°ëŠ¥ì‹í’ˆ ì¼ë°˜ ì£¼ì˜" style="font-size: 0.7rem;"><i class="fas fa-user-md me-1"></i>ì˜ì•½í’ˆë³µìš©ì</button>
                                        <button type="button" class="btn btn-outline-info btn-sm py-0 px-2 quick-text-toggle" data-field="cautions" data-text="ì„ì‚°ë¶€ ë° ìˆ˜ìœ ë¶€, ì–´ë¦°ì´(ë˜ëŠ” íŠ¹ì • ì—°ë ¹ì¸µ)ëŠ” ì„­ì·¨ì— ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤." title="íŠ¹ì • ëŒ€ìƒ ì£¼ì˜" style="font-size: 0.7rem;"><i class="fas fa-baby me-1"></i>ì„ì‚°ë¶€/ì–´ë¦°ì´</button>
                                        <button type="button" class="btn btn-outline-info btn-sm py-0 px-2 quick-text-toggle" data-field="cautions" data-text="ë³¸ ì œí’ˆ ì„­ì·¨ ì‹œ ì´ìƒ ì‚¬ë¡€ ë°œìƒ ë˜ëŠ” ë¶ˆí¸í•¨ì„ ëŠë¼ëŠ” ê²½ìš°, ì„­ì·¨ë¥¼ ì¤‘ë‹¨í•˜ê³  ì†Œë¹„ì ìƒë‹´ì‹¤ ë˜ëŠ” 1577-2488(ì´ìƒì‚¬ë¡€ ì‹ ê³  í•«ë¼ì¸)ë¡œ ì‹ ê³ í•˜ì—¬ ì£¼ì‹­ì‹œì˜¤." title="ì´ìƒì‚¬ë¡€ ì‹ ê³ " style="font-size: 0.7rem;"><i class="fas fa-phone-volume me-1"></i>ì´ìƒì‚¬ë¡€</button>
                                    </div>
                                    <textarea name="cautions" class="form-control auto-resize" rows="1" placeholder="ì£¼ì˜ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”" id="cautions_textarea" style="width: 100%;"></textarea>
                                </div>
                            </div>

                            <!-- ê¸°íƒ€í‘œì‹œì‚¬í•­ -->
                            <div class="form-group-row align-start">
                                <div class="form-label-cell">
                                    <input type="checkbox" id="chk_additional_info" class="form-check-input me-2">
                                    <label for="chk_additional_info">ê¸°íƒ€í‘œì‹œì‚¬í•­</label>
                                </div>
                                <div class="form-input-cell" style="align-items: flex-start; flex-direction: column; gap: 5px; height: auto;">
                                    <!-- ì „ì²´ ì¶”ê°€/í•´ì œ ë²„íŠ¼ -->
                                    <div class="d-flex justify-content-between align-items-center mb-1" style="width: 100%;">
                                        <span style="font-size: 0.75rem; color: #666;">
                                            <i class="fas fa-info-circle me-1"></i>ë¹ ë¥¸ ì…ë ¥ ë²„íŠ¼
                                        </span>
                                        <div class="btn-group btn-group-sm" role="group">
                                            <button type="button" class="btn btn-outline-success btn-sm" onclick="addAllQuickTexts('additional_info')" style="font-size: 0.7rem; padding: 0.2rem 0.5rem;">
                                                <i class="fas fa-plus-circle me-1"></i>ì „ì²´ ì¶”ê°€
                                            </button>
                                            <button type="button" class="btn btn-outline-danger btn-sm" onclick="clearAllQuickTexts('additional_info')" style="font-size: 0.7rem; padding: 0.2rem 0.5rem;">
                                                <i class="fas fa-eraser me-1"></i>ì¼ê´„ í•´ì œ
                                            </button>
                                        </div>
                                    </div>
                                    <div class="quick-text-buttons" style="display: flex; flex-wrap: wrap; gap: 3px; width: 100%; margin-bottom: 3px;">
                                        <!-- ì†Œë¹„ì í–‰ì •/í’ˆì§ˆ ê´€ë ¨ (ë²•ì • í•„ìˆ˜) -->
                                        <button type="button" class="btn btn-outline-primary btn-sm py-0 px-2 quick-text-toggle" data-field="additional_info" data-text="ì œí’ˆì— ëŒ€í•œ ë¬¸ì˜ ì‚¬í•­ ë° ìƒë‹´ì€ ì¢…í•©ìƒë‹´ì„¼í„° 1577-1255 (ìœ ë£Œ)ë¡œ ì—°ë½ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤." title="ì†Œë¹„ì ìƒë‹´ì‹¤ (ë²•ì • í•„ìˆ˜)" style="font-size: 0.7rem;"><i class="fas fa-headset me-1"></i>ìƒë‹´ì„¼í„°</button>
                                        <button type="button" class="btn btn-outline-primary btn-sm py-0 px-2 quick-text-toggle" data-field="additional_info" data-text="ë³¸ ì œí’ˆì€ ê³µì •ê±°ë˜ìœ„ì›íšŒ ê³ ì‹œ ì†Œë¹„ìë¶„ìŸí•´ê²°ê¸°ì¤€ì— ì˜ê±°, êµí™˜ ë˜ëŠ” ë³´ìƒë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤." title="í’ˆì§ˆë³´ì¦ (ë¶„ìŸí•´ê²°ê¸°ì¤€)" style="font-size: 0.7rem;"><i class="fas fa-certificate me-1"></i>í’ˆì§ˆë³´ì¦</button>
                                        
                                        <!-- ì¸ì¦ ë§ˆí¬ (ì¡°ê±´ë¶€ í•„ìˆ˜) -->
                                        <button type="button" class="btn btn-outline-success btn-sm py-0 px-2 quick-text-toggle" data-field="additional_info" data-text="HACCP ì¸ì¦ ì œí’ˆ" title="HACCP ì¸ì¦" style="font-size: 0.7rem;"><i class="fas fa-check-circle me-1"></i>HACCP</button>
                                        <button type="button" class="btn btn-outline-success btn-sm py-0 px-2 quick-text-toggle" data-field="additional_info" data-text="ISO 22000 ì¸ì¦" title="ISO 22000" style="font-size: 0.7rem;"><i class="fas fa-award me-1"></i>ISO22000</button>
                                        <button type="button" class="btn btn-outline-success btn-sm py-0 px-2 quick-text-toggle" data-field="additional_info" data-text="ìœ ê¸°ë† ì¸ì¦ ì œí’ˆ" title="ìœ ê¸°ë† ì¸ì¦" style="font-size: 0.7rem;"><i class="fas fa-leaf me-1"></i>ìœ ê¸°ë†</button>
                                        <button type="button" class="btn btn-outline-success btn-sm py-0 px-2 quick-text-toggle" data-field="additional_info" data-text="KS ì¸ì¦ ì œí’ˆ" title="KS ì¸ì¦" style="font-size: 0.7rem;"><i class="fas fa-stamp me-1"></i>KS</button>
                                        <button type="button" class="btn btn-outline-success btn-sm py-0 px-2 quick-text-toggle" data-field="additional_info" data-text="ì „í†µì‹í’ˆ í’ˆì§ˆì¸ì¦" title="ì „í†µì‹í’ˆ" style="font-size: 0.7rem;"><i class="fas fa-landmark me-1"></i>ì „í†µì‹í’ˆ</button>
                                        <button type="button" class="btn btn-outline-success btn-sm py-0 px-2 quick-text-toggle" data-field="additional_info" data-text="ìš°ìˆ˜ì‹í’ˆì¸ì¦(GMP)" title="GMP" style="font-size: 0.7rem;"><i class="fas fa-star me-1"></i>GMP</button>
                                        <button type="button" class="btn btn-outline-success btn-sm py-0 px-2 quick-text-toggle" data-field="additional_info" data-text="ì €íƒ„ì†Œ ì¸ì¦ ì œí’ˆ" title="ì €íƒ„ì†Œ ì¸ì¦ (ì˜¨ì‹¤ê°€ìŠ¤ ë°°ì¶œëŸ‰ ê°ì¶•)" style="font-size: 0.7rem;"><i class="fas fa-seedling me-1"></i>ì €íƒ„ì†Œ</button>
                                        
                                        <!-- ê·œì œëœ ìë°œì  í´ë ˆì„ (ê¸°ì¤€ ì¶©ì¡± í•„ìˆ˜) -->
                                        <button type="button" class="btn btn-outline-info btn-sm py-0 px-2 quick-text-toggle" data-field="additional_info" data-text="ë¬´ ê¸€ë£¨í… (Gluten Free)" title="ì´ ê¸€ë£¨í… í•¨ëŸ‰ 1kgë‹¹ 20mg ì´í•˜" style="font-size: 0.7rem;"><i class="fas fa-wheat-awn me-1"></i>ë¬´ê¸€ë£¨í…</button>
                                        <button type="button" class="btn btn-outline-info btn-sm py-0 px-2 quick-text-toggle" data-field="additional_info" data-text="ë¹„ê±´ ì¸ì¦ (Vegan)" title="ë™ë¬¼ ìœ ë˜ ì„±ë¶„ ë¶ˆí¬í•¨" style="font-size: 0.7rem;"><i class="fas fa-leaf me-1"></i>ë¹„ê±´</button>
                                        <button type="button" class="btn btn-outline-info btn-sm py-0 px-2 quick-text-toggle" data-field="additional_info" data-text="í• ë„(Halal) ì¸ì¦ ì œí’ˆ" title="í• ë„ ì¸ì¦" style="font-size: 0.7rem;"><i class="fas fa-moon me-1"></i>í• ë„</button>
                                        
                                        <!-- ì¼ë°˜ ìë°œì  í‘œì‹œ -->
                                        <button type="button" class="btn btn-outline-secondary btn-sm py-0 px-2 quick-text-toggle" data-field="additional_info" data-text="ë¬´(ç„¡) MSG, ë¬´(ç„¡) í•©ì„±ë³´ì¡´ë£Œ, ë¬´(ç„¡) í•©ì„±ì°©ìƒ‰ë£Œ" title="ë¬´ì²¨ê°€" style="font-size: 0.7rem;"><i class="fas fa-ban me-1"></i>ë¬´ì²¨ê°€</button>
                                        <button type="button" class="btn btn-outline-secondary btn-sm py-0 px-2 quick-text-toggle" data-field="additional_info" data-text="Non-GMO ì œí’ˆ" title="Non-GMO" style="font-size: 0.7rem;"><i class="fas fa-dna me-1"></i>Non-GMO</button>
                                        <button type="button" class="btn btn-outline-secondary btn-sm py-0 px-2 quick-text-toggle" data-field="additional_info" data-text="ì €ë‚˜íŠ¸ë¥¨ ì œí’ˆ" title="ì €ë‚˜íŠ¸ë¥¨" style="font-size: 0.7rem;"><i class="fas fa-heart me-1"></i>ì €ë‚˜íŠ¸ë¥¨</button>
                                    </div>
                                    <textarea name="additional_info" class="form-control auto-resize" rows="1" placeholder="ê¸°íƒ€ í‘œì‹œì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”" style="width: 100%;"></textarea>
                                </div>
                            </div>

                            </div><!-- end tab-notices -->
                            
                            <!-- íƒ­ 4: ê¸°íƒ€í•­ëª© -->
                            <div class="tab-content-panel" id="tab-additional">

                            <!-- ìš©ê¸°Â·í¬ì¥ì¬ì§ˆ -->
                            <div class="form-group-row">
                                <div class="form-label-cell">
                                    <input type="checkbox" id="chk_frmlc_mtrqlt" class="form-check-input me-2">
                                    <label for="chk_frmlc_mtrqlt">ìš©ê¸°Â·í¬ì¥ì¬ì§ˆ</label>
                                </div>
                                <div class="form-input-cell">
                                    <input type="text" name="frmlc_mtrqlt" class="form-control" placeholder="ì˜ˆ) PET, í”Œë¼ìŠ¤í‹±, ìœ ë¦¬">
                                </div>
                            </div>

                            <!-- ì œì¡°ì› ì†Œì¬ì§€ -->
                            <div class="form-group-row">
                                <div class="form-label-cell">
                                    <input type="checkbox" id="chk_bssh_nm" class="form-check-input me-2">
                                    <label for="chk_bssh_nm">ì œì¡°ì› ì†Œì¬ì§€</label>
                                </div>
                                <div class="form-input-cell">
                                    <input type="text" name="bssh_nm" class="form-control" placeholder="ì œì¡°ì› ì†Œì¬ì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                                </div>
                            </div>

                            <!-- ìœ í†µì „ë¬¸íŒë§¤ì› -->
                            <div class="form-group-row">
                                <div class="form-label-cell">
                                    <input type="checkbox" id="chk_distributor_address" class="form-check-input me-2">
                                    <label for="chk_distributor_address">ìœ í†µì „ë¬¸íŒë§¤ì›</label>
                                </div>
                                <div class="form-input-cell">
                                    <input type="text" name="distributor_address" class="form-control" placeholder="ìœ í†µì „ë¬¸íŒë§¤ì›ì„ ì…ë ¥í•˜ì„¸ìš”">
                                </div>
                            </div>

                            <!-- ì†Œë¶„ì› -->
                            <div class="form-group-row">
                                <div class="form-label-cell">
                                    <input type="checkbox" id="chk_repacker_address" class="form-check-input me-2">
                                    <label for="chk_repacker_address">ì†Œë¶„ì›</label>
                                </div>
                                <div class="form-input-cell">
                                    <input type="text" name="repacker_address" class="form-control" placeholder="ì†Œë¶„ì›ì„ ì…ë ¥í•˜ì„¸ìš”">
                                </div>
                            </div>

                            <!-- ìˆ˜ì…ì› -->
                            <div class="form-group-row">
                                <div class="form-label-cell">
                                    <input type="checkbox" id="chk_importer_address" class="form-check-input me-2">
                                    <label for="chk_importer_address">ìˆ˜ì…ì›</label>
                                </div>
                                <div class="form-input-cell">
                                    <input type="text" name="importer_address" class="form-control" placeholder="ìˆ˜ì…ì›ì„ ì…ë ¥í•˜ì„¸ìš”">
                                </div>
                            </div>

                            <!-- ë¶„ë¦¬ë°°ì¶œë§ˆí¬ -->
                            <div class="form-group-row">
                                <div class="form-label-cell">
                                    <span style="width: 1em; margin-right: 0.5rem;"></span>
                                    <label for="recyclingMarkSelect">ë¶„ë¦¬ë°°ì¶œë§ˆí¬</label>
                                </div>
                                <div class="form-input-cell">
                                    <div class="d-flex gap-2 align-items-center">
                                        <select class="form-select form-select-sm" id="recyclingMarkSelect" style="flex: 1; max-width: 200px;">
                                            <option value="">ë§ˆí¬ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                                            <optgroup label="í”Œë¼ìŠ¤í‹±">
                                                <option value="ë¬´ìƒ‰í˜íŠ¸">ë¬´ìƒ‰í˜íŠ¸</option>
                                                <option value="ìœ ìƒ‰í˜íŠ¸">ìœ ìƒ‰í˜íŠ¸</option>
                                                <option value="í”Œë¼ìŠ¤í‹±(PET)">í”Œë¼ìŠ¤í‹±(PET)</option>
                                                <option value="í”Œë¼ìŠ¤í‹±(HDPE)">í”Œë¼ìŠ¤í‹±(HDPE)</option>
                                                <option value="í”Œë¼ìŠ¤í‹±(LDPE)">í”Œë¼ìŠ¤í‹±(LDPE)</option>
                                                <option value="í”Œë¼ìŠ¤í‹±(PP)">í”Œë¼ìŠ¤í‹±(PP)</option>
                                                <option value="í”Œë¼ìŠ¤í‹±(PS)">í”Œë¼ìŠ¤í‹±(PS)</option>
                                                <option value="ê¸°íƒ€í”Œë¼ìŠ¤í‹±">ê¸°íƒ€í”Œë¼ìŠ¤í‹±</option>
                                            </optgroup>
                                            <optgroup label="ì¢…ì´">
                                                <option value="ì¢…ì´">ì¢…ì´</option>
                                                <option value="ì¼ë°˜íŒ©">ì¼ë°˜íŒ©</option>
                                                <option value="ë©¸ê· íŒ©">ë©¸ê· íŒ©</option>
                                            </optgroup>
                                            <optgroup label="ê¸ˆì†">
                                                <option value="ìº”ë¥˜(ì² )">ìº”ë¥˜(ì² )</option>
                                                <option value="ìº”ë¥˜(ì•Œë¯¸ëŠ„)">ìº”ë¥˜(ì•Œë¯¸ëŠ„)</option>
                                            </optgroup>
                                            <optgroup label="ìœ ë¦¬">
                                                <option value="ìœ ë¦¬">ìœ ë¦¬</option>
                                            </optgroup>
                                            <optgroup label="ë¹„ë‹">
                                                <option value="ë¹„ë‹(PET)">ë¹„ë‹(PET)</option>
                                                <option value="ë¹„ë‹(HDPE)">ë¹„ë‹(HDPE)</option>
                                                <option value="ë¹„ë‹(LDPE)">ë¹„ë‹(LDPE)</option>
                                                <option value="ë¹„ë‹(PP)">ë¹„ë‹(PP)</option>
                                                <option value="ë¹„ë‹(PS)">ë¹„ë‹(PS)</option>
                                                <option value="ë¹„ë‹(ê¸°íƒ€)">ë¹„ë‹(ê¸°íƒ€)</option>
                                            </optgroup>
                                        </select>
                                        <button type="button" class="btn btn-outline-primary btn-sm" id="addRecyclingMarkBtn" style="white-space: nowrap;">ì¶”ê°€</button>
                                        <input type="text" class="form-control form-control-sm" id="additionalRecyclingText" placeholder="ë³µí•©ì¬ì§ˆ ì˜ˆ: ëª¸ì²´(ì¢…ì´)/ëšœê»‘(PP)" style="flex: 1;">
                                    </div>
                                </div>
                            </div>

                            </div><!-- end tab-additional -->
                            
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- íŒ¨ë„ ë¦¬ì‚¬ì´ì € -->
        <div class="panel-resizer"></div>

        <!-- ì˜¤ë¥¸ìª½ íŒ¨ë„: ë¯¸ë¦¬ë³´ê¸° ì˜ì—­ -->
        <div class="col-12 col-lg-6 demo-right-panel">
            <div class="card modern-card">
                <div class="card-header bg-success text-white">
                    <div class="d-flex justify-content-between align-items-center flex-wrap" style="gap: 8px;">
                        <h5 class="mb-0"><i class="fas fa-eye me-2"></i>2. ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°</h5>
                        <div class="preview-actions d-flex gap-1">
                            <button class="btn btn-sm btn-header-success py-1 px-2" id="validateButton" title="ê·œì • ê²€ì¦"><i class="fas fa-check-circle me-1"></i>ê·œì • ê²€ì¦</button>
                            <button class="btn btn-sm btn-header-success py-1 px-2" id="exportPdfBtn" title="PDF ì €ì¥"><i class="fas fa-file-pdf me-1"></i>PDF ì €ì¥</button>
                            <button class="btn btn-sm btn-header-success py-1 px-2" id="toggleSettingsBtn" title="ì„œì‹ ì„¤ì • ì—´ê¸°/ë‹«ê¸°"><i class="fas fa-cog me-1"></i>ì„¤ì • ì—´ê¸°</button>
                            <button class="btn btn-sm btn-header-danger py-1 px-2" id="resetPreviewSettingsBtn" title="ì„¤ì • ì´ˆê¸°í™”"><i class="fas fa-sync-alt"></i></button>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <!-- ë¯¸ë¦¬ë³´ê¸° í¬ê¸° ë° ê¸€ê¼´ ì„¤ì • íŒ¨ë„ (í†µí•©) - 1ì¤„ ë°°ì¹˜ -->
                    <div class="mb-2 pb-2 border-bottom" id="settingsPanelDemo" style="display: none;">
                        <div class="row g-2 align-items-end">
                            <div class="col">
                                <label class="form-label mb-1 text-xs" for="widthInput">ê°€ë¡œ(cm)</label>
                                <input type="number" class="form-control form-control-sm" id="widthInput" value="10" min="4" max="50" step="1" style="font-size: 0.8rem; padding: 0.25rem 0.3rem;">
                            </div>
                            <div class="col">
                                <label class="form-label mb-1 text-xs">ì„¸ë¡œ(cm)</label>
                                <input type="text" class="form-control form-control-sm" id="heightInput" readonly style="font-size: 0.8rem; padding: 0.25rem 0.3rem; background: #f8f9fa;">
                            </div>
                            <div class="col">
                                <label class="form-label mb-1 text-xs">ë©´ì (cmÂ²)</label>
                                <input type="text" class="form-control form-control-sm" id="areaDisplay" readonly style="font-size: 0.8rem; padding: 0.25rem 0.3rem; background: #f8f9fa;">
                            </div>
                            <div class="col">
                                <label class="form-label mb-1 text-xs" for="fontFamilySelect">ê¸€ê¼´</label>
                                <select class="form-select form-select-sm" id="fontFamilySelect" style="font-size: 0.8rem; padding: 0.25rem 0.3rem;">
                                    <option value="'Noto Sans KR', sans-serif" selected>ë…¸í†  ì‚°ìŠ¤</option>
                                    <option value="'Nanum Gothic', sans-serif">ë‚˜ëˆ”ê³ ë”•</option>
                                    <option value="'Nanum Myeongjo', serif">ë‚˜ëˆ”ëª…ì¡°</option>
                                </select>
                            </div>
                            <div class="col">
                                <label class="form-label mb-1 text-xs" for="fontSizeInput">í¬ê¸°(pt)</label>
                                <input type="number" class="form-control form-control-sm" id="fontSizeInput" value="10" min="7" max="20" step="0.5" style="font-size: 0.8rem; padding: 0.25rem 0.3rem;">
                            </div>
                            <div class="col">
                                <label class="form-label mb-1 text-xs" for="letterSpacingInput">ìê°„(%)</label>
                                <input type="number" class="form-control form-control-sm" id="letterSpacingInput" value="-5" min="-20" max="20" step="1" style="font-size: 0.8rem; padding: 0.25rem 0.3rem;">
                            </div>
                            <div class="col">
                                <label class="form-label mb-1 text-xs" for="lineHeightInput">ì¤„ê°„ê²©</label>
                                <input type="number" class="form-control form-control-sm" id="lineHeightInput" value="1.5" min="1" max="3.0" step="0.1" style="font-size: 0.8rem; padding: 0.25rem 0.3rem;">
                            </div>
                        </div>
                    </div>

                    <!-- ê²€ì¦ ê²°ê³¼ íŒ¨ë„ -->
                    <div id="validationResults" class="alert" style="display: none;"></div>

                    <!-- ë¯¸ë¦¬ë³´ê¸° ì»¨í…ì¸  -->
                    <div class="preview-content-area">
                        <div id="previewContent" style="min-height: 300px; background: white; padding: 1rem; border: 1px solid #dee2e6; border-radius: 8px;">
                            <p class="text-center text-muted" style="padding: 2rem;">
                                <i class="fas fa-info-circle me-2"></i>
                                ìƒ˜í”Œì„ ì„ íƒí•˜ê±°ë‚˜ ì™¼ìª½ì— í•­ëª©ì„ ì…ë ¥í•˜ë©´ ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°ê°€ í‘œì‹œë©ë‹ˆë‹¤.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ë¡œê·¸ì¸ ëª¨ë‹¬ -->
<!-- ì €ì¥ ê¸°ëŠ¥ ë¡œê·¸ì¸ ëª¨ë‹¬ -->
<div class="modal fade" id="loginModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-gradient" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                <h5 class="modal-title">
                    <i class="fas fa-save me-2"></i>í‘œì‹œì‚¬í•­ì„ ì €ì¥í•˜ì‹œê² ì–´ìš”?
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body text-center py-4">
                <div class="mb-3">
                    <i class="fas fa-cloud-upload-alt fa-4x mb-3" style="color: #667eea;"></i>
                </div>
                <h5 class="mb-3">ì§€ê¸ˆ ì‘ì„±í•œ ë‚´ìš©ì„ ì•ˆì „í•˜ê²Œ ë³´ê´€í•˜ì„¸ìš”!</h5>
                <div class="text-start mb-3" style="background: #f8f9fa; padding: 1.5rem; border-radius: 10px;">
                    <p class="mb-2"><strong>ë¡œê·¸ì¸í•˜ì‹œë©´:</strong></p>
                    <ul class="list-unstyled mb-0">
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>ì‘ì„±í•œ ë‚´ìš©ì´ ìë™ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤</li>
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>ì–¸ì œë“ ì§€ ë‹¤ì‹œ ë¶ˆëŸ¬ì™€ì„œ ìˆ˜ì • ê°€ëŠ¥</li>
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>í‘œì‹œì‚¬í•­ ë¦¬ìŠ¤íŠ¸ì—ì„œ í•œëˆˆì— ê´€ë¦¬</li>
                        <li class="mb-0"><i class="fas fa-check-circle text-success me-2"></i>PDF ë‹¤ìš´ë¡œë“œ ë° ì¸ì‡„ ê¸°ëŠ¥ ì œê³µ</li>
                    </ul>
                </div>
            </div>
            <div class="modal-footer justify-content-center border-0 pt-0 pb-4">
                <a href="{% url 'user_management:signup' %}" class="btn btn-primary btn-lg px-5">
                    <i class="fas fa-user-plus me-2"></i>ê°€ì…í•˜ê¸°
                </a>
                <a href="{% url 'user_management:login' %}?next=/" class="btn btn-outline-primary btn-lg px-5">
                    <i class="fas fa-sign-in-alt me-2"></i>ë¡œê·¸ì¸
                </a>
            </div>
        </div>
    </div>
</div>

<!-- ê¸°ëŠ¥ ìœ ë„ ëª¨ë‹¬ -->
<div class="modal fade" id="featureModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-gradient" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                <h5 class="modal-title">
                    <i class="fas fa-star me-2"></i><span id="featureModalTitle">íšŒì› ì „ìš© ê¸°ëŠ¥</span>
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body text-center py-4">
                <div class="mb-3">
                    <i id="featureModalIcon" class="fas fa-list fa-4x mb-3" style="color: #667eea;"></i>
                </div>
                <h5 class="mb-3" id="featureModalSubtitle">íšŒì›ë‹˜ì„ ìœ„í•œ íŠ¹ë³„í•œ ê¸°ëŠ¥!</h5>
                <div class="text-start mb-3" style="background: #f8f9fa; padding: 1.5rem; border-radius: 10px;">
                    <p class="mb-2"><strong>ê°€ì…í•˜ì‹œë©´ ì´ëŸ° ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”:</strong></p>
                    <ul class="list-unstyled mb-0">
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>ì‘ì„±í•œ í‘œì‹œì‚¬í•­ì„ ì €ì¥í•˜ê³  ê´€ë¦¬</li>
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>ì–¸ì œë“ ì§€ ìˆ˜ì • ë° ì¬ì‚¬ìš© ê°€ëŠ¥</li>
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>ê°„í¸ ëª¨ë“œ â†” ìƒì„¸ ëª¨ë“œ ììœ ë¡­ê²Œ ë³´ê¸°</li>
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>ì œí’ˆ ì¡°íšŒ í™”ë©´ì—ì„œ ì‹ì•½ì²˜ ì‹ ê³  ì œí’ˆ ì¡°íšŒ ê¸°ëŠ¥</li>
                        <li class="mb-0"><i class="fas fa-check-circle text-success me-2"></i>ë‹¤ì–‘í•œ í…œí”Œë¦¿ ë° ì›ì¬ë£Œ ë°ì´í„°ë² ì´ìŠ¤ í™œìš©</li>
                    </ul>
                </div>
            </div>
            <div class="modal-footer justify-content-center border-0 pt-0 pb-4">
                <a href="{% url 'user_management:signup' %}" class="btn btn-primary btn-lg px-5">
                    <i class="fas fa-user-plus me-2"></i>ê°€ì…í•˜ê¸°
                </a>
                <a href="{% url 'user_management:login' %}?next=/" class="btn btn-outline-primary btn-lg px-5">
                    <i class="fas fa-sign-in-alt me-2"></i>ë¡œê·¸ì¸
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script src="{% static 'js/label/constants.js' %}"></script>

<script>
// êµ­ê°€ ëª©ë¡ì„ JavaScriptì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì „ì—­ ë³€ìˆ˜ë¡œ ì„¤ì •
window.countryListForBold = [
    {% for country in countries %}
    "{{ country.country_name_ko|escapejs }}"{% if not forloop.last %},{% endif %}
    {% endfor %}
];
</script>

<script src="{% static 'js/home_demo.js' %}"></script>

{% if current_label %}
<script>
// ì„œë²„ì—ì„œ ë¡œë“œëœ ë¼ë²¨ ë°ì´í„°ê°€ ìˆìŒì„ í‘œì‹œ (localStorage ë¡œë“œ ë°©ì§€)
window.hasServerLabelData = true;

// ë¼ë²¨ ë°ì´í„° ìë™ ë¡œë“œ
document.addEventListener('DOMContentLoaded', function() {
    // ë‹¤ë¥¸ ì´ˆê¸°í™”ê°€ ì™„ë£Œë  ë•Œê¹Œì§€ ì•½ê°„ ì§€ì—°
    setTimeout(function() {
        // ëª¨ë“œ ì „í™˜ìœ¼ë¡œ ë³µì›ëœ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ì„œë²„ ë°ì´í„° ë¡œë“œ ê±´ë„ˆë›°ê¸°
        if (window.formDataRestored) {
            return;
        }
        
        const labelData = {{ current_label_json|safe }};
        
        // í¼ í•„ë“œì— ë°ì´í„° ì±„ìš°ê¸°
        const form = document.getElementById('demoForm');
        if (form && labelData) {
        // ë¼ë²¨ëª…
        if (labelData.my_label_name) {
            const labelNameField = form.querySelector('[name="label_name"]');
            if (labelNameField) {
                labelNameField.value = labelData.my_label_name;
                // ë¼ë²¨ëª… ì²´í¬ë°•ìŠ¤ë„ ì²´í¬
                const chkLabelName = document.getElementById('chk_label_name');
                if (chkLabelName) chkLabelName.checked = true;
            }
        }
        
        // ê¸°ë³¸ ì •ë³´
        if (labelData.prdlst_nm) form.querySelector('[name="prdlst_nm"]').value = labelData.prdlst_nm;
        if (labelData.ingredient_info) form.querySelector('[name="ingredient_info"]').value = labelData.ingredient_info;
        if (labelData.prdlst_dcnm) form.querySelector('[name="prdlst_dcnm"]').value = labelData.prdlst_dcnm;
        if (labelData.prdlst_report_no) form.querySelector('[name="prdlst_report_no"]').value = labelData.prdlst_report_no;
        
        // í’ˆëª©ë³´ê³ ë²ˆí˜¸ ê²€ì¦ ìƒíƒœ ë³µì› (ë¦¬ìŠ¤íŠ¸ í‘œì‹œìš©)
        if (labelData.report_no_verify_YN) {
            const hiddenInput = document.getElementById('report_no_verify_yn_value');
            if (hiddenInput) {
                hiddenInput.value = labelData.report_no_verify_YN;
            }
        }
        
        if (labelData.content_weight) form.querySelector('[name="content_weight"]').value = labelData.content_weight;
        if (labelData.weight_calorie) form.querySelector('[name="weight_calorie"]').value = labelData.weight_calorie;
        
        // ì›ì‚°ì§€ ë° ë³´ê´€
        if (labelData.country_of_origin) form.querySelector('[name="country_of_origin"]').value = labelData.country_of_origin;
        if (labelData.storage_method) form.querySelector('[name="storage_method"]').value = labelData.storage_method;
        if (labelData.frmlc_mtrqlt) form.querySelector('[name="frmlc_mtrqlt"]').value = labelData.frmlc_mtrqlt;
        if (labelData.pog_daycnt) form.querySelector('[name="pog_daycnt"]').value = labelData.pog_daycnt;
        
        // ì›ì¬ë£Œëª…
        if (labelData.rawmtrl_nm_display) form.querySelector('[name="rawmtrl_nm_display"]').value = labelData.rawmtrl_nm_display;
        
        // ì œì¡°ì› ë“±
        if (labelData.bssh_nm) form.querySelector('[name="bssh_nm"]').value = labelData.bssh_nm;
        if (labelData.distributor_address) form.querySelector('[name="distributor_address"]').value = labelData.distributor_address;
        if (labelData.repacker_address) form.querySelector('[name="repacker_address"]').value = labelData.repacker_address;
        if (labelData.importer_address) form.querySelector('[name="importer_address"]').value = labelData.importer_address;
        
        // ì£¼ì˜ì‚¬í•­ ë° ê¸°íƒ€
        if (labelData.cautions) form.querySelector('[name="cautions"]').value = labelData.cautions;
        if (labelData.additional_info) form.querySelector('[name="additional_info"]').value = labelData.additional_info;
        
        // ì²´í¬ë°•ìŠ¤ ìƒíƒœ ë³µì›
        if (typeof labelData.chk_prdlst_nm !== 'undefined') {
            const checkboxes = [
                'chk_label_name', 'chk_prdlst_nm', 'chk_ingredient_info', 'chk_prdlst_dcnm', 
                'chk_prdlst_report_no', 'chk_content_weight', 'chk_country_of_origin',
                'chk_storage_method', 'chk_pog_daycnt', 'chk_rawmtrl_nm_display',
                'chk_cautions', 'chk_additional_info', 'chk_frmlc_mtrqlt',
                'chk_bssh_nm', 'chk_distributor_address', 'chk_repacker_address',
                'chk_importer_address', 'chk_recycling_mark'
            ];
            checkboxes.forEach(id => {
                const checkbox = document.getElementById(id);
                if (checkbox && typeof labelData[id] !== 'undefined') {
                    checkbox.checked = labelData[id];
                }
            });
        }
        
        // ì•Œë ˆë¥´ê¸° ì •ë³´ ë³µì›
        if (labelData.allergens && typeof window.selectedIngredientAllergens !== 'undefined') {
            window.selectedIngredientAllergens.clear();
            const allergenList = labelData.allergens.split(',').map(a => a.trim()).filter(Boolean);
            allergenList.forEach(allergen => {
                window.selectedIngredientAllergens.add(allergen);
            });
            if (typeof updateAllergenDisplay === 'function') {
                updateAllergenDisplay();
            }
        }
        
        // textarea ë†’ì´ ì¡°ì ˆ
        document.querySelectorAll('textarea.auto-resize').forEach(textarea => {
            if (textarea.value) {
                autoResizeHeight(textarea);
            }
        });
        
        // ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
        setTimeout(() => {
            updatePreview();
        }, 100);
    }
    }, 500); // ë³µì› ì™„ë£Œ í›„ ì‹¤í–‰ë˜ë„ë¡ ì¶©ë¶„í•œ ì§€ì—°
});
</script>
{% endif %}
{% endblock %}
