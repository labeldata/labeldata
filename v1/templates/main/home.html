{% extends 'base.html' %}
{% load static %}
{% block title %}ë©”ì¸ í™”ë©´{% endblock %}

{% block content %}
<!-- ì‹œìŠ¤í…œ ì†Œê°œ ì˜ì—­ -->
<div class="system-intro">
    <div class="intro-box">
        <h1 class="intro-title">"ê°„í¸í•œ í‘œì‹œì‚¬í•­ ì—°êµ¬ì†Œ"ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤.</h1>
        <p class="intro-description">
            í‘œì‹œì‚¬í•­ì„ ì œì‘í•˜ê¸° ìœ„í•œ ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.
        </p>
        <!-- [ìˆ˜ì •] íŠœí† ë¦¬ì–¼ ì‹œì‘ ì˜ì—­ í†µí•© -->
        <div id="start-tutorial-area">
            <h2 class="tutorial-area-title">ã€Œì‹œìŠ¤í…œ íŠœí† ë¦¬ì–¼ ë°”ë¡œê°€ê¸°ã€</h2>
            <ul class="intro-list">
                <li>ì œí’ˆ ì¡°íšŒ: êµ­ë‚´ì™¸ ì‹í’ˆ ì •ë³´ ê²€ìƒ‰ ë° ì €ì¥(ë‚´ ì›ë£Œ, í‘œì‹œì‚¬í•­)</li>
                <li>ì›ë£Œ ê´€ë¦¬: ë‚´ ì›ë£Œ ì €ì¥, ìƒì„¸ì •ë³´ ì…ë ¥(í‘œì‹œëª…, ì•Œë ˆë¥´ê¸° ë“±)</li>
                <li>í‘œì‹œì‚¬í•­ ê´€ë¦¬: í‘œì‹œì‚¬í•­ ì‘ì„±, ê·œì •ê²€ì¦, ë¯¸ë¦¬ë³´ê¸°, ë‹¤ìš´ë¡œë“œ
                    <ul class="sub-list">
                        <li>ì‹í’ˆìœ í˜•ì— ë”°ë¥¸ í•„ìˆ˜ í•­ëª© ì¶”ì²œ</li>
                        <li>ìì£¼ ì‚¬ìš©í•˜ëŠ” ë¬¸êµ¬ ì¶”ì²œ ë° ë¶ˆëŸ¬ì˜¤ê¸°</li>
                        <li>ì›ë£Œ í•¨ëŸ‰ì— ë”°ë¥¸ ì›ì¬ë£Œëª… ìë™ ìƒì„±Â·ê²€ì¦</li>
                        <li>ì˜ì–‘ì„±ë¶„ ê³„ì‚°ê¸°</li>
                        <li>ì„œì‹ ë¯¸ë¦¬ë³´ê¸° ë° ê·œì • ê²€ì¦</li>
                        <li>PDF ì €ì¥ ë° ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</li>
                    </ul>
                </li>
            </ul>
        </div>
        <div class="highlight-feature">
            <span>ìƒˆë¡œìš´ ê¸°ëŠ¥ ê³§ ê³µê°œ! </span>
            <a href="{% url 'board:list' %}" class="cta-button">ê²Œì‹œíŒì—ì„œ ì•„ì´ë””ì–´ ê³µìœ í•´ì£¼ì„¸ìš” ğŸ˜Š</a>
        </div>
    </div>
</div>

<!-- íŠœí† ë¦¬ì–¼ ì˜¤ë²„ë ˆì´ UI -->
<div id="tutorial-overlay" style="display: none;">
    <button id="tutorial-close-btn" class="tutorial-btn">&times;</button>
    <button id="tutorial-prev-btn" class="tutorial-btn tutorial-nav-btn">&lt;</button>
    <button id="tutorial-next-btn" class="tutorial-btn tutorial-nav-btn">&gt;</button>

    <div class="tutorial-content-main">
        <div id="tutorial-text-content">
            <h3 id="tutorial-title"></h3>
            <p id="tutorial-description"></p>
        </div>
        <img id="tutorial-image" src="" alt="íŠœí† ë¦¬ì–¼ ë‹¨ê³„ë³„ ì˜ˆì‹œ í™”ë©´">
    </div>

    <div id="tutorial-progress-bar"></div>
</div>


<style>
/* --- ê¸°ì¡´ ìŠ¤íƒ€ì¼ --- */
.system-intro {
    background-color: #f8fafc; padding: 2rem; display: flex; align-items: center; justify-content: center;
    margin-top: 4rem; border-radius: 10px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); min-height: auto;
}
.intro-box { max-width: 800px; text-align: center; }
.intro-title {
    font-size: clamp(1.5rem, 3vw, 2.5rem); font-weight: 700; color: #1a3c34;
    margin-bottom: 1rem; white-space: nowrap;
}
.intro-description {
    font-size: clamp(1rem, 2vw, 1.2rem); color: #4a5568; margin-bottom: 2rem; line-height: 1.6;
}

/* [ì¶”ê°€] íŠœí† ë¦¬ì–¼ ì‹œì‘ ì˜ì—­ ìŠ¤íƒ€ì¼ */
#start-tutorial-area {
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    padding: 1.5rem;
    margin-bottom: 2rem;
    cursor: pointer;
    transition: box-shadow 0.3s ease, transform 0.3s ease;
    background-color: #f0fdfa; /* [ìˆ˜ì •] ë°°ê²½ìƒ‰ ì¶”ê°€ */
}
#start-tutorial-area:hover {
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
    transform: translateY(-5px);
}
.tutorial-area-title {
    font-size: 1.5rem; /* [ìˆ˜ì •] í°íŠ¸ í¬ê¸° ì¦ê°€ */
    color: #38b2ac;
    font-weight: 700; /* [ìˆ˜ì •] í°íŠ¸ êµµê¸° ì¦ê°€ */
    margin-top: 0;
    margin-bottom: 1rem;
}

.intro-list { list-style: none; padding: 0; text-align: left; font-size: clamp(0.9rem, 1.5vw, 1.1rem); color: #2d3748; line-height: 1.6; }
.intro-list li { margin-bottom: 0.5rem; }
.sub-list { margin-top: 0.5rem; margin-left: 1.5rem; list-style-type: disc; }
.sub-list li { font-size: clamp(0.85rem, 1.4vw, 1rem); color: #4a5568; }
.highlight-feature {
    background-color: #e6fffa; padding: 1rem; border-radius: 8px; display: flex;
    align-items: center; justify-content: space-between; flex-wrap: wrap; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}
.highlight-feature span { font-size: clamp(1rem, 1.5vw, 1.1rem); font-weight: 600; color: #2b6cb0; }
.cta-button {
    display: inline-block; background-color: #38b2ac; color: white; padding: 0.625rem 1.25rem;
    border-radius: 6px; text-decoration: none; font-size: clamp(0.9rem, 1.5vw, 1rem); transition: background-color 0.3s ease;
    border: none; cursor: pointer;
}
.cta-button:hover { background-color: #319795; }

/* --- íŠœí† ë¦¬ì–¼ ì˜¤ë²„ë ˆì´ ìŠ¤íƒ€ì¼ --- */
/* [ì¶”ê°€] íŠœí† ë¦¬ì–¼ ì„¤ëª… ê°•ì¡° ìŠ¤íƒ€ì¼ */
.highlight-text {
    color: #ffeb3b; /* ë…¸ë€ìƒ‰ */
    font-weight: 600;
}

.tutorial-highlight {
    position: relative;
    z-index: 1001;
    box-shadow: 0 0 0 3px #38b2ac;
    border-radius: 5px;
    transition: box-shadow 0.3s ease-in-out;
}
#tutorial-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background-color: rgba(0, 0, 0, 0.85); z-index: 1000; display: flex;
    align-items: center; justify-content: center; flex-direction: column;
    padding-top: 70px; box-sizing: border-box;
}
.tutorial-btn { background: none; border: none; color: white; cursor: pointer; font-family: 'Arial', sans-serif; }
#tutorial-close-btn {
    position: absolute; top: 40px; right: 30px; font-size: 3rem;
    opacity: 0.8; transition: opacity 0.2s;
}
#tutorial-close-btn:hover { opacity: 1; }
.tutorial-nav-btn {
    position: absolute; top: 50%; transform: translateY(-50%); font-size: 3rem;
    padding: 10px 20px; border-radius: 10px; background-color: rgba(0, 0, 0, 0.3);
    transition: background-color 0.2s;
}
.tutorial-nav-btn:hover { background-color: rgba(0, 0, 0, 0.5); }
#tutorial-prev-btn { left: 20px; }
#tutorial-next-btn { right: 20px; }
.tutorial-content-main {
    max-width: 70vw; max-height: calc(85vh - 70px); display: flex;
    flex-direction: column; align-items: center;
}
#tutorial-image { max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 8px; }
#tutorial-text-content {
    color: white; text-align: center; margin-bottom: 20px; background-color: rgba(0, 0, 0, 0.4);
    padding: 15px; border-radius: 8px; width: 100%; box-sizing: border-box;
}
#tutorial-title { margin: 0 0 10px 0; font-size: 1.5rem; }
#tutorial-description { margin: 0; font-size: 1.1rem; line-height: 1.5; }
#tutorial-progress-bar { position: absolute; bottom: 30px; display: flex; gap: 8px; }
.progress-dot {
    width: 12px; height: 12px; border-radius: 50%;
    background-color: rgba(255, 255, 255, 0.4); transition: background-color 0.3s;
}
.progress-dot.active { background-color: white; }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // [ìˆ˜ì •] íŠœí† ë¦¬ì–¼ ì‹œì‘ ë²„íŠ¼ì„ ìƒˆë¡œìš´ ì˜ì—­ìœ¼ë¡œ ë³€ê²½
    const startBtn = document.getElementById('start-tutorial-area');
    if (!startBtn) return;

    const overlay = document.getElementById('tutorial-overlay');
    const closeBtn = document.getElementById('tutorial-close-btn');
    const nextBtn = document.getElementById('tutorial-next-btn');
    const prevBtn = document.getElementById('tutorial-prev-btn');
    
    const titleEl = document.getElementById('tutorial-title');
    const imageEl = document.getElementById('tutorial-image');
    const descriptionEl = document.getElementById('tutorial-description');
    const progressBar = document.getElementById('tutorial-progress-bar');

    // [ìˆ˜ì •] êµ¬ë¬¸ ì˜¤ë¥˜ ìˆ˜ì • ë° ì˜¤íƒ€ êµì •
    const tutorialSteps = [
        { element: '#nav-food-item-list', title: 'ì œí’ˆ ì¡°íšŒ(1) : êµ­ë‚´/ìˆ˜ì…ì œí’ˆ ê²€ìƒ‰', image: "{% static 'img/tutorial/step-1-1.png' %}", 
        description: 'êµ­ë‚´ì™¸ 150ë§Œ ê±´ì˜ í‘œì‹œì‚¬í•­ì„ <span class="highlight-text">â‘ ì¡°ê±´ ê²€ìƒ‰, â‘¡í’ˆëª© ì„ íƒ</span> í›„ ìƒì„¸ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.' },
        { element: '#nav-food-item-list', title: 'ì œí’ˆ ì¡°íšŒ(2) : ì›ë£Œ, ì œí’ˆ ì €ì¥', image: "{% static 'img/tutorial/step-1-2.png' %}", 
        description: 'ì œí’ˆ ì •ë³´ëŠ” <span class="highlight-text">â‘ ë‚´ì›ë£Œ ì €ì¥, â‘¡í‘œì‹œì‚¬í•­ ìƒì„±</span> ë²„íŠ¼ìœ¼ë¡œ ì‰½ê²Œ ë³µì‚¬í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.' },
        { element: '#nav-ingredient-management', title: 'ì›ë£Œ ê´€ë¦¬(1) : ìƒì„¸ì •ë³´ ê´€ë¦¬', image: "{% static 'img/tutorial/step-2-1.png' %}", 
        description: 'ì›ë£Œ ë¦¬ìŠ¤íŠ¸ì—ì„œ <span class="highlight-text">â‘ ì„ íƒ í›„ â‘¡ìƒì„¸ì •ë³´ ì…ë ¥, â‘¢ì €ì¥</span>í•˜ë©´ í‘œì‹œì‚¬í•­ ì‘ì„±í•  ë•Œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.' +
        '<br>â€»ì‹í’ˆì²¨ê°€ë¬¼ì€ ê´€ë ¨ ê·œì •ì— ë”°ë¼ í‘œì‹œë¬¸êµ¬ë¥¼ ì¶”ì²œí•´ì¤ë‹ˆë‹¤.' },
        { element: '#nav-ingredient-management', title: 'ì›ë£Œ ê´€ë¦¬(2) : ì‹ ê·œë“±ë¡, ì—‘ì…€ ë‹¤ìš´/ì—…ë¡œë“œ', image: "{% static 'img/tutorial/step-2-2.png' %}", 
        description: 'ì›ë£Œ ì •ë³´ëŠ” <span class="highlight-text">â‘ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ë° ì¼ê´„ ì—…ë¡œë“œ, â‘¡ì‹ ê·œ ì¶”ê°€</span>ë„ ê°€ëŠ¥í•˜ë©°, <span class="highlight-text">â‘¢ì—°ê²°ëœ í‘œì‹œì‚¬í•­ì„ ì§ì ‘ ì¡°íšŒ</span>í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.' +
        '<br>â€»ì—‘ì…€ ì—…ë¡œë“œ ì‹œì—ëŠ” ë‹¤ìš´ë°›ì€ ì–‘ì‹ì— ë°ì´í„°ë¥¼ ì…ë ¥í•˜ì—¬ ì—…ë¡œë“œí•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.' },
        { element: '#nav-label-management', title: 'í‘œì‹œì‚¬í•­ ê´€ë¦¬(1) : ë‹¤ìš´ë¡œë“œ,ë³µì‚¬,ì‚­ì œ, í’ˆë³´ì‹ ê³  ê²€ì¦', image: "{% static 'img/tutorial/step-3-1.png' %}", 
        description: 'í‘œì‹œì‚¬í•­ ë¦¬ìŠ¤íŠ¸ë¥¼ ì„ íƒí•˜ì—¬ <span class="highlight-text">â‘ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ, ë³µì‚¬, ì‚­ì œ</span>ë¥¼ í•  ìˆ˜ ìˆê³ , <br>í‘œì‹œì‚¬í•­ì— ì…ë ¥í•œ í’ˆëª©ë³´ê³ ë²ˆí˜¸ì˜ <span class="highlight-text">â‘¡ì‹¤ì œ ì‹ ê³  ì—¬ë¶€ë„ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸</span> ê°€ëŠ¥í•©ë‹ˆë‹¤.' },
        { element: '#nav-label-management', title: 'í‘œì‹œì‚¬í•­ ê´€ë¦¬(2) : ì‹í’ˆìœ í˜•ë³„ í•„ìˆ˜í•­ëª© ìë™ ì¶”ì²œ', image: "{% static 'img/tutorial/step-3-2.png' %}", 
        description: 'í‘œì‹œì‚¬í•­ ì‘ì„± í™”ë©´ì—ì„œ <span class="highlight-text">â‘ ì‹í’ˆìœ í˜• ì„ íƒ, â‘¡ì œì¡°ë°©ë²• ë° ì¥ê¸°ë³´ì¡´ ì„ íƒ, â‘¢í•„ìˆ˜í•­ëª© ì ìš© í›„ ì ‘ê¸°</span> ë²„íŠ¼ì„ í´ë¦­í•˜ë©´,' +
        '<br> "ìƒì„¸ ì…ë ¥" í™”ë©´ì˜ í•„ìˆ˜ í•­ëª©ì´ ìë™ ì²´í¬ë˜ê³ , ì˜¤ë¥¸ìª½ íŒ¨ë„ì—ì„œëŠ” ì‹í’ˆìœ í˜•ë³„ ê´€ë ¨ ê·œì •ë„ í‘œì‹œë©ë‹ˆë‹¤.' },
        { element: '#nav-label-management', title: 'í‘œì‹œì‚¬í•­ ê´€ë¦¬(3) : ìƒì„¸ì •ë³´ ì…ë ¥', image: "{% static 'img/tutorial/step-3-3.png' %}", 
        description: 'ê° í•­ëª©ì˜ ì…ë ¥í•„ë“œë¥¼ ì„ íƒí•˜ë©´ ì˜¤ë¥¸ìª½ íŒ¨ë„ì— <span class="highlight-text">â‘ ê´€ë ¨ ê·œì • í‘œì‹œ</span>ë˜ê³  ë° <span class="highlight-text">â‘ ìì£¼ ì‚¬ìš©í•˜ëŠ” ë¬¸êµ¬ ë“±ë¡ ë° ì„ íƒí•˜ì—¬ ì‰½ê²Œ ì…ë ¥</span>í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ' +
        '<br>í’ˆëª©ë³´ê³ ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ê³  ë²ˆí˜¸ê²€ì¦ ê¸°ëŠ¥ì„ í†µí•´<span class="highlight-text">â‘¡ì‚¬ìš© ì—¬ë¶€ë¥¼ ì‹¤ì‹œê°„ í™•ì¸</span>í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.' +
        '<br>ì›ë£Œ ê´€ë¦¬ì—ì„œ ë“±ë¡í•œ ì›ë£Œë¥¼ "í‘œë¡œ ì…ë ¥" ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ <span class="highlight-text">â‘¢ì›ì¬ë£Œëª… ìë™ ì¶”ì²œ ê¸°ëŠ¥</span>ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.' },        
        { element: '#nav-label-management', title: 'í‘œì‹œì‚¬í•­ ê´€ë¦¬(4) : ì›ì¬ë£Œ í‘œì‹œëª… ì¶”ì²œ', image: "{% static 'img/tutorial/step-3-4.png' %}", description: 'ë“±ë¡ëœ ì›ë£Œë¥¼ ê²€ìƒ‰í•˜ì—¬ <span class="highlight-text">â‘ ì¶”ê°€, â‘¡ ë¹„ìœ¨ ì…ë ¥ì´ë‚˜ ìˆœì„œ ë³€ê²½, â‘¢ í‘œì‹œê·œì¹™ ì„ íƒ</span>í•˜ë©´ <br> ì›ì¬ë£Œ í‘œì‹œëª… ë° ì•Œë ˆë¥´ê¸°/GMO ì„±ë¶„ì´ ìë™ìœ¼ë¡œ ìƒì„±ë˜ê³ , ì‹í’ˆìœ í˜• ë° í•¨ëŸ‰ì— ë”°ë¥¸ ì›ì‚°ì§€ í‘œì‹œëŒ€ìƒê³¼ êµ­ê°€ëª… í¬í•¨ ì—¬ë¶€ë¥¼ ë‚˜íƒ€ë‚´ì¤ë‹ˆë‹¤.' },
        { element: '#nav-label-management', title: 'í‘œì‹œì‚¬í•­ ê´€ë¦¬(5) : í‘œì‹œì‚¬í•­ ë¯¸ë¦¬ë³´ê¸°', image: "{% static 'img/tutorial/step-3-5.png' %}", 
        description: 'í‘œì‹œì‚¬í•­ ì‘ì„± í™”ë©´ì˜ ìš°ì¸¡ ìƒë‹¨ "ë¯¸ë¦¬ë³´ê¸°" ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ í•œê¸€í‘œì‹œì‚¬í•­ì˜<span class="highlight-text">â‘ í¬ê¸° ì„¤ì • ë³€ê²½</span>í•˜ê³ , <span class="highlight-text">â‘¡ë¶„ë¦¬ë°°ì¶œ ë§ˆí¬ ì¶”ê°€</span> ë“±ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.' },
        { element: '#nav-label-management', title: 'í‘œì‹œì‚¬í•­ ê´€ë¦¬(6) : ê·œì • ê²€ì¦ ë° PDF ì €ì¥', image: "{% static 'img/tutorial/step-3-6.png' %}", 
        description: 'ì™„ì„±ëœ í‘œì‹œì‚¬í•­ì´ <span class="highlight-text">â‘ ê·œì •ì— ë§ëŠ”ì§€ ê²€ì¦</span>í•˜ê³ , ê²°ê³¼ë¥¼ <span class="highlight-text">â‘¡PDF íŒŒì¼ë¡œ ì €ì¥</span>í•˜ì—¬ ê³µìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.' }
    ];

    let currentStep = 0;
    let highlightedElement = null;

    function createProgressBar() {
        progressBar.innerHTML = '';
        tutorialSteps.forEach((_, index) => {
            const dot = document.createElement('div');
            dot.classList.add('progress-dot');
            dot.dataset.index = index;
            dot.addEventListener('click', () => showStep(index));
            progressBar.appendChild(dot);
        });
    }

    function showStep(stepIndex) {
        if (stepIndex < 0 || stepIndex >= tutorialSteps.length) {
            return;
        }
        currentStep = stepIndex;
        const step = tutorialSteps[stepIndex];

        if (highlightedElement) {
            highlightedElement.classList.remove('tutorial-highlight');
        }
        const targetElement = document.querySelector(step.element);
        if (targetElement) {
            highlightedElement = targetElement;
            targetElement.classList.add('tutorial-highlight');
        }

        titleEl.textContent = step.title;
        imageEl.src = step.image;
        // [ìˆ˜ì •] textContentë¥¼ innerHTMLë¡œ ë³€ê²½í•˜ì—¬ span íƒœê·¸ê°€ ì ìš©ë˜ë„ë¡ í•¨
        descriptionEl.innerHTML = step.description;

        prevBtn.style.display = stepIndex > 0 ? 'block' : 'none';
        nextBtn.style.display = stepIndex < tutorialSteps.length - 1 ? 'block' : 'none';

        document.querySelectorAll('.progress-dot').forEach((dot, index) => {
            dot.classList.toggle('active', index === currentStep);
        });
    }

    function handleKeyPress(e) {
        if (e.key === 'ArrowRight') {
            showStep(currentStep + 1);
        } else if (e.key === 'ArrowLeft') {
            showStep(currentStep - 1);
        } else if (e.key === 'Escape') {
            endTutorial();
        }
    }

    function startTutorial(e) {
        e.preventDefault();
        createProgressBar();
        overlay.style.display = 'flex';
        document.addEventListener('keydown', handleKeyPress);
        showStep(0);
    }

    function endTutorial() {
        overlay.style.display = 'none';
        if (highlightedElement) {
            highlightedElement.classList.remove('tutorial-highlight');
            highlightedElement = null;
        }
        document.removeEventListener('keydown', handleKeyPress);
        currentStep = 0;
    }

    startBtn.addEventListener('click', startTutorial);
    closeBtn.addEventListener('click', endTutorial);
    nextBtn.addEventListener('click', () => showStep(currentStep + 1));
    prevBtn.addEventListener('click', () => showStep(currentStep - 1));
});
</script>

{% endblock %}