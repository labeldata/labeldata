{% extends 'base.html' %}
{% load static %}
{% block title %}ë©”ì¸ í™”ë©´{% endblock %}

{% block content %}
<!-- ì‹œìŠ¤í…œ ì†Œê°œ ì˜ì—­ -->
<div class="system-intro">
    <div class="intro-box">
        <h1 class="intro-title">"ê°„í¸í•œ í‘œì‹œì‚¬í•­ ì—°êµ¬ì†Œ"ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤.</h1>
        <p class="intro-description">
            í‘œì‹œì‚¬í•­ì„ ì œì‘í•˜ê¸° ìœ„í•œ ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.
        </p>
        <!-- [ìˆ˜ì •] íŠœí† ë¦¬ì–¼ ì‹œì‘ ì˜ì—­ í†µí•© -->
        <div id="start-tutorial-area">
            <h2 class="tutorial-area-title">ã€Œì‹œìŠ¤í…œ íŠœí† ë¦¬ì–¼ ë°”ë¡œê°€ê¸°ã€</h2>
            <ul class="intro-list">
                <li>ì œí’ˆ ì¡°íšŒ: êµ­ë‚´ì™¸ ì‹í’ˆ ì •ë³´ ê²€ìƒ‰ ë° ì €ì¥(ë‚´ ì›ë£Œ, í‘œì‹œì‚¬í•­)</li>
                <li>ì›ë£Œ ê´€ë¦¬: ë‚´ ì›ë£Œ ì €ì¥, ìƒì„¸ì •ë³´ ì…ë ¥(í‘œì‹œëª…, ì•Œë ˆë¥´ê¸° ë“±)</li>
                <li>í‘œì‹œì‚¬í•­ ê´€ë¦¬: í‘œì‹œì‚¬í•­ ì‘ì„±, ê·œì •ê²€ì¦, ë¯¸ë¦¬ë³´ê¸°, ë‹¤ìš´ë¡œë“œ
                    <ul class="sub-list">
                        <li>ì‹í’ˆìœ í˜•ì— ë”°ë¥¸ í•„ìˆ˜ í•­ëª© ì¶”ì²œ</li>
                        <li>ìì£¼ ì‚¬ìš©í•˜ëŠ” ë¬¸êµ¬ ì¶”ì²œ ë° ë¶ˆëŸ¬ì˜¤ê¸°</li>
                        <li>ì›ë£Œ í•¨ëŸ‰ì— ë”°ë¥¸ ì›ì¬ë£Œëª… ìë™ ìƒì„±Â·ê²€ì¦</li>
                        <li>ì˜ì–‘ì„±ë¶„ ê³„ì‚°ê¸°</li>
                        <li>ì„œì‹ ë¯¸ë¦¬ë³´ê¸° ë° ê·œì • ê²€ì¦</li>
                        <li>PDF ì €ì¥ ë° ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</li>
                    </ul>
                </li>
            </ul>
        </div>
        <div class="highlight-feature">
            <span>ìƒˆë¡œìš´ ê¸°ëŠ¥ ê³§ ê³µê°œ! </span>
            <a href="{% url 'board:list' %}" class="cta-button">ê²Œì‹œíŒì—ì„œ ì•„ì´ë””ì–´ ê³µìœ í•´ì£¼ì„¸ìš” ğŸ˜Š</a>
        </div>
    </div>
</div>

<!-- íŠœí† ë¦¬ì–¼ ì˜¤ë²„ë ˆì´ UI -->
<div id="tutorial-overlay" style="display: none;">
    <button id="tutorial-close-btn" class="tutorial-btn">&times;</button>
    <button id="tutorial-prev-btn" class="tutorial-btn tutorial-nav-btn">&lt;</button>
    <button id="tutorial-next-btn" class="tutorial-btn tutorial-nav-btn">&gt;</button>

    <div class="tutorial-content-main">
        <div id="tutorial-text-content">
            <h3 id="tutorial-title"></h3>
            <p id="tutorial-description"></p>
        </div>
        <img id="tutorial-image" src="" alt="íŠœí† ë¦¬ì–¼ ë‹¨ê³„ë³„ ì˜ˆì‹œ í™”ë©´">
    </div>

    <div id="tutorial-progress-bar"></div>
</div>


<style>
/* --- ê¸°ì¡´ ìŠ¤íƒ€ì¼ --- */
.system-intro {
    background-color: #f8fafc; padding: 2rem; display: flex; align-items: center; justify-content: center;
    margin-top: 4rem; border-radius: 10px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); min-height: auto;
}
.intro-box { max-width: 800px; text-align: center; }
.intro-title {
    font-size: clamp(1.5rem, 3vw, 2.5rem); font-weight: 700; color: #1a3c34;
    margin-bottom: 1rem; white-space: nowrap;
}
.intro-description {
    font-size: clamp(1rem, 2vw, 1.2rem); color: #4a5568; margin-bottom: 2rem; line-height: 1.6;
}

/* [ì¶”ê°€] íŠœí† ë¦¬ì–¼ ì‹œì‘ ì˜ì—­ ìŠ¤íƒ€ì¼ */
#start-tutorial-area {
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    padding: 1.5rem;
    margin-bottom: 2rem;
    cursor: pointer;
    transition: box-shadow 0.3s ease, transform 0.3s ease;
    background-color: #ffffff;
}
#start-tutorial-area:hover {
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
    transform: translateY(-5px);
}
.tutorial-area-title {
    font-size: 1.3rem;
    color: #38b2ac;
    font-weight: 600;
    margin-top: 0;
    margin-bottom: 1rem;
}

.intro-list { list-style: none; padding: 0; text-align: left; font-size: clamp(0.9rem, 1.5vw, 1.1rem); color: #2d3748; line-height: 1.6; }
.intro-list li { margin-bottom: 0.5rem; }
.sub-list { margin-top: 0.5rem; margin-left: 1.5rem; list-style-type: disc; }
.sub-list li { font-size: clamp(0.85rem, 1.4vw, 1rem); color: #4a5568; }
.highlight-feature {
    background-color: #e6fffa; padding: 1rem; border-radius: 8px; display: flex;
    align-items: center; justify-content: space-between; flex-wrap: wrap; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}
.highlight-feature span { font-size: clamp(1rem, 1.5vw, 1.1rem); font-weight: 600; color: #2b6cb0; }
.cta-button {
    display: inline-block; background-color: #38b2ac; color: white; padding: 0.625rem 1.25rem;
    border-radius: 6px; text-decoration: none; font-size: clamp(0.9rem, 1.5vw, 1rem); transition: background-color 0.3s ease;
    border: none; cursor: pointer;
}
.cta-button:hover { background-color: #319795; }

/* --- íŠœí† ë¦¬ì–¼ ì˜¤ë²„ë ˆì´ ìŠ¤íƒ€ì¼ --- */
.tutorial-highlight {
    position: relative;
    z-index: 1001;
    box-shadow: 0 0 0 3px #38b2ac;
    border-radius: 5px;
    transition: box-shadow 0.3s ease-in-out;
}
#tutorial-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background-color: rgba(0, 0, 0, 0.85); z-index: 1000; display: flex;
    align-items: center; justify-content: center; flex-direction: column;
    padding-top: 70px; box-sizing: border-box;
}
.tutorial-btn { background: none; border: none; color: white; cursor: pointer; font-family: 'Arial', sans-serif; }
#tutorial-close-btn {
    position: absolute; top: 40px; right: 30px; font-size: 3rem;
    opacity: 0.8; transition: opacity 0.2s;
}
#tutorial-close-btn:hover { opacity: 1; }
.tutorial-nav-btn {
    position: absolute; top: 50%; transform: translateY(-50%); font-size: 3rem;
    padding: 10px 20px; border-radius: 10px; background-color: rgba(0, 0, 0, 0.3);
    transition: background-color 0.2s;
}
.tutorial-nav-btn:hover { background-color: rgba(0, 0, 0, 0.5); }
#tutorial-prev-btn { left: 20px; }
#tutorial-next-btn { right: 20px; }
.tutorial-content-main {
    max-width: 70vw; max-height: calc(85vh - 70px); display: flex;
    flex-direction: column; align-items: center;
}
#tutorial-image { max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 8px; }
#tutorial-text-content {
    color: white; text-align: center; margin-bottom: 20px; background-color: rgba(0, 0, 0, 0.4);
    padding: 15px; border-radius: 8px; width: 100%; box-sizing: border-box;
}
#tutorial-title { margin: 0 0 10px 0; font-size: 1.5rem; }
#tutorial-description { margin: 0; font-size: 1.1rem; line-height: 1.5; }
#tutorial-progress-bar { position: absolute; bottom: 30px; display: flex; gap: 8px; }
.progress-dot {
    width: 12px; height: 12px; border-radius: 50%;
    background-color: rgba(255, 255, 255, 0.4); transition: background-color 0.3s;
}
.progress-dot.active { background-color: white; }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // [ìˆ˜ì •] íŠœí† ë¦¬ì–¼ ì‹œì‘ ë²„íŠ¼ì„ ìƒˆë¡œìš´ ì˜ì—­ìœ¼ë¡œ ë³€ê²½
    const startBtn = document.getElementById('start-tutorial-area');
    if (!startBtn) return;

    const overlay = document.getElementById('tutorial-overlay');
    const closeBtn = document.getElementById('tutorial-close-btn');
    const nextBtn = document.getElementById('tutorial-next-btn');
    const prevBtn = document.getElementById('tutorial-prev-btn');
    
    const titleEl = document.getElementById('tutorial-title');
    const imageEl = document.getElementById('tutorial-image');
    const descriptionEl = document.getElementById('tutorial-description');
    const progressBar = document.getElementById('tutorial-progress-bar');

    const tutorialSteps = [
        { element: '#nav-food-item-list', title: '1-1. ì œí’ˆ ì¡°íšŒ : êµ­ë‚´/ìˆ˜ì…ì œí’ˆ ê²€ìƒ‰', image: "{% static 'img/tutorial/step-1-1.png' %}", description: '150ë§Œ ê±´ì˜ êµ­ë‚´ì™¸ ì‹í’ˆì˜ í‘œì‹œì‚¬í•­ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.' },
        { element: '#nav-food-item-list', title: '1-2. ì œí’ˆ ì¡°íšŒ : ì›ë£Œì™€ ì œí’ˆì„ ê°ê° ë³µì‚¬', image: "{% static 'img/tutorial/step-1-2.png' %}", description: 'ê²€ìƒ‰í•œ ì œí’ˆì˜ ì •ë³´ë¥¼ â‘ í´ë¦­ í•œ ë²ˆìœ¼ë¡œ ë‚´ ì›ë£Œ ë˜ëŠ” ë‚´ í‘œì‹œì‚¬í•­ìœ¼ë¡œ ê°„í¸í•˜ê²Œ ë³µì‚¬ í›„ â‘¡í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.' },
        { element: '#nav-ingredient-management', title: '2-1. ì›ë£Œ ê´€ë¦¬ : ì›ë£Œì˜ ìƒì„¸ ì •ë³´ë¥¼ ì…ë ¥', image: "{% static 'img/tutorial/step-2-1.png' %}", description: 'ì €ì¥ëœ ì›ë£Œì˜ ì•Œë ˆë¥´ê¸°, ì›ì‚°ì§€ ë“± ìƒì„¸ ì •ë³´ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.' },
        { element: '#nav-ingredient-management', title: '2-2. ì›ë£Œ ê´€ë¦¬ : ì›ë£Œ ë°ì´í„° ì—‘ì…€ ì—…ë¡œë“œ', image: "{% static 'img/tutorial/step-2-2.png' %}", description: 'ì—‘ì…€ ì–‘ì‹ì„ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ì—¬ëŸ¬ í’ˆëª©ì„ í•œ ë²ˆì— ì—…ë¡œë“œí•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.' },
        { element: '#nav-label-management', title: '3-1. í‘œì‹œì‚¬í•­ ê´€ë¦¬ : í‘œì‹œì‚¬í•­ ì‘ì„± ëŒ€ìƒ ì„ íƒ', image: "{% static 'img/tutorial/step-3-1.png' %}", description: 'ìƒˆë¡œìš´ í‘œì‹œì‚¬í•­ì„ ë§Œë“¤ê±°ë‚˜, ê¸°ì¡´ì— ì €ì¥ëœ í‘œì‹œì‚¬í•­ì„ ë³µì‚¬í•˜ì—¬ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.' },
        { element: '#nav-label-management', title: '3-2. í‘œì‹œì‚¬í•­ ê´€ë¦¬ : í•„ìˆ˜í•­ëª© ìë™ ì¶”ì²œ', image: "{% static 'img/tutorial/step-3-2.png' %}", description: 'ì‹í’ˆìœ í˜•ì„ ì„ íƒí•˜ë©´ ê´€ë ¨ ê·œì •ì— ë”°ë¥¸ í•„ìˆ˜ í‘œì‹œí•­ëª©ì´ ìë™ìœ¼ë¡œ ì¶”ì²œë©ë‹ˆë‹¤.' },
        { element: '#nav-label-management', title: '3-3. í‘œì‹œì‚¬í•­ ê´€ë¦¬ : ìì£¼ ì‚¬ìš©í•˜ëŠ” ë¬¸êµ¬ ì„¤ì •', image: "{% static 'img/tutorial/step-3-3.png' %}", description: 'ë³´ê´€ë°©ë²•, ì£¼ì˜ì‚¬í•­ ë“± ìì£¼ ì‚¬ìš©í•˜ëŠ” ë¬¸êµ¬ë¥¼ ì €ì¥í•´ë‘ê³  ê°„í¸í•˜ê²Œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.' },
        { element: '#nav-label-management', title: '3-4. í‘œì‹œì‚¬í•­ ê´€ë¦¬ : ì›ì¬ë£Œëª… ìë™ ìƒì„±', image: "{% static 'img/tutorial/step-3-4.png' %}", description: 'ì›ë£Œì™€ í•¨ëŸ‰ì„ â‘ ì¶”ê°€, â‘¡ ë¹„ìœ¨ ì…ë ¥, â‘¢ í‘œì‹œê·œì¹™ ì¡°ì •í•˜ë©´ ì›ì¬ë£Œëª… ì˜ˆì‹œê°€ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤.' },
        { element: '#nav-label-management', title: '3-5. í‘œì‹œì‚¬í•­ ê´€ë¦¬ : ë¯¸ë¦¬ë³´ê¸° ë° ì„¤ì • ì¡°ì •', image: "{% static 'img/tutorial/step-3-5.png' %}", description: 'ì‘ì„±ëœ í‘œì‹œì‚¬í•­ì„ ë¯¸ë¦¬ë³´ê¸°ì—ì„œ â‘ ì„¤ì • ë³€ê²½í•˜ê³ . â‘¡ë¶„ë¦¬ë°°ì¶œ ë§ˆí¬ ì¶”ê°€ ë“±ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.' },
        { element: '#nav-label-management', title: '3-6. í‘œì‹œì‚¬í•­ ê´€ë¦¬ : ê·œì • ê²€ì¦ ë° PDF ì €ì¥', image: "{% static 'img/tutorial/step-3-6.png' %}", description: 'ì™„ì„±ëœ í‘œì‹œì‚¬í•­ì´ â‘ ê·œì •ì— ë§ëŠ”ì§€ ê²€ì¦í•˜ê³ , ê²°ê³¼ë¥¼ â‘¡PDF íŒŒì¼ë¡œ ì €ì¥í•˜ì—¬ ê³µìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.' },
        { element: '#nav-label-management', title: '3-7. í‘œì‹œì‚¬í•­ ê´€ë¦¬ : ë¦¬ìŠ¤íŠ¸ì—ì„œ ì¡°íšŒ,ê´€ë¦¬', image: "{% static 'img/tutorial/step-3-7.png' %}", description: 'ì‘ì„±ëœ í‘œì‹œì‚¬í•­ì„ â‘ í’ˆëª©ë³´ê³  ì—¬ë¶€, â‘¡ë‹¤ìš´ë¡œë“œ, ìˆ˜ì •, ì‚­ì œ, ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.' }    ];

    let currentStep = 0;
    let highlightedElement = null;

    function createProgressBar() {
        progressBar.innerHTML = '';
        tutorialSteps.forEach((_, index) => {
            const dot = document.createElement('div');
            dot.classList.add('progress-dot');
            dot.dataset.index = index;
            dot.addEventListener('click', () => showStep(index));
            progressBar.appendChild(dot);
        });
    }

    function showStep(stepIndex) {
        if (stepIndex < 0 || stepIndex >= tutorialSteps.length) {
            return;
        }
        currentStep = stepIndex;
        const step = tutorialSteps[stepIndex];

        if (highlightedElement) {
            highlightedElement.classList.remove('tutorial-highlight');
        }
        const targetElement = document.querySelector(step.element);
        if (targetElement) {
            highlightedElement = targetElement;
            targetElement.classList.add('tutorial-highlight');
        }

        titleEl.textContent = step.title;
        imageEl.src = step.image;
        descriptionEl.textContent = step.description;

        prevBtn.style.display = stepIndex > 0 ? 'block' : 'none';
        nextBtn.style.display = stepIndex < tutorialSteps.length - 1 ? 'block' : 'none';

        document.querySelectorAll('.progress-dot').forEach((dot, index) => {
            dot.classList.toggle('active', index === currentStep);
        });
    }

    function handleKeyPress(e) {
        if (e.key === 'ArrowRight') {
            showStep(currentStep + 1);
        } else if (e.key === 'ArrowLeft') {
            showStep(currentStep - 1);
        } else if (e.key === 'Escape') {
            endTutorial();
        }
    }

    function startTutorial(e) {
        e.preventDefault();
        createProgressBar();
        overlay.style.display = 'flex';
        document.addEventListener('keydown', handleKeyPress);
        showStep(0);
    }

    function endTutorial() {
        overlay.style.display = 'none';
        if (highlightedElement) {
            highlightedElement.classList.remove('tutorial-highlight');
            highlightedElement = null;
        }
        document.removeEventListener('keydown', handleKeyPress);
        currentStep = 0;
    }

    startBtn.addEventListener('click', startTutorial);
    closeBtn.addEventListener('click', endTutorial);
    nextBtn.addEventListener('click', () => showStep(currentStep + 1));
    prevBtn.addEventListener('click', () => showStep(currentStep - 1));
});
</script>

{% endblock %}