{% extends 'base.html' %}

{% block title %}게시판 목록{% endblock %}

{% block content %}
<div class="container my-4">
    <h2 class="mb-4">게시판</h2>

    <!-- 검색 폼 -->
    <form method="get" class="mb-4 d-flex">
        <input type="text" name="q" class="form-control me-2" placeholder="검색어 입력" value="{{ request.GET.q }}">
        <button type="submit" class="btn btn-primary">검색</button>
    </form>

    <!-- 정렬 버튼 -->
    <div class="d-flex justify-content-end mb-3">
        <a href="?order=-create_date" class="btn btn-outline-primary me-2 {% if order == '-create_date' %}active{% endif %}">
            최신순
        </a>
        <a href="?order=create_date" class="btn btn-outline-secondary {% if order == 'create_date' %}active{% endif %}">
            오래된 순
        </a>
    </div>

    <!-- 게시물 목록 -->
    <table class="table table-bordered table-hover align-middle">
        <thead class="table-light">
            <tr>
                <th scope="col" class="text-center">번호</th>
                <th scope="col">제목</th>
                <th scope="col" class="text-center">작성자</th>
                <th scope="col" class="text-center">작성일</th>
            </tr>
        </thead>
        <tbody>
            {% for post in page_obj %}
            <tr style="cursor: pointer;" onclick="location.href='{% url 'label:post_detail' post.id %}'">
                <td class="text-center">{{ forloop.counter }}</td>
                <td>{{ post.title }}</td>
                <td class="text-center">{{ post.author.username }}</td>
                <td class="text-center">{{ post.create_date|date:"Y-m-d" }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" class="text-center text-muted">게시물이 없습니다.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- 페이지네이션 -->
    <div class="d-flex justify-content-center mt-4">
        <nav>
            <ul class="pagination">
                {% for page in page_obj.paginator.page_range %}
                <li class="page-item {% if page_obj.number == page %}active{% endif %}">
                    <a class="page-link" href="?page={{ page }}&order={{ order }}">{{ page }}</a>
                </li>
                {% endfor %}
            </ul>
        </nav>
    </div>

    <!-- 새 글 작성 버튼 -->
    <div class="text-end mt-4">
        <a href="{% url 'label:post_create' %}" class="btn btn-success">새 글 작성</a>
    </div>
</div>
{% endblock %}
